<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Callable parameters and interpolating data · ModelingToolkit.jl</title><meta name="title" content="Callable parameters and interpolating data · ModelingToolkit.jl"/><meta property="og:title" content="Callable parameters and interpolating data · ModelingToolkit.jl"/><meta property="twitter:title" content="Callable parameters and interpolating data · ModelingToolkit.jl"/><meta name="description" content="Documentation for ModelingToolkit.jl."/><meta property="og:description" content="Documentation for ModelingToolkit.jl."/><meta property="twitter:description" content="Documentation for ModelingToolkit.jl."/><meta property="og:url" content="https://docs.sciml.ai/ModelingToolkit/stable/tutorials/callable_params/"/><meta property="twitter:url" content="https://docs.sciml.ai/ModelingToolkit/stable/tutorials/callable_params/"/><link rel="canonical" href="https://docs.sciml.ai/ModelingToolkit/stable/tutorials/callable_params/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ModelingToolkit.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ModelingToolkit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../ode_modeling/">Getting Started with ModelingToolkit.jl</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../acausal_components/">Acausal Component-Based Modeling</a></li><li><a class="tocitem" href="../nonlinear/">Modeling Nonlinear Systems</a></li><li><a class="tocitem" href="../initialization/">Initialization of Systems</a></li><li><a class="tocitem" href="../optimization/">Modeling Optimization Problems</a></li><li><a class="tocitem" href="../modelingtoolkitize/">Modelingtoolkitize: Automatically Translating Numerical to Symbolic Code</a></li><li><a class="tocitem" href="../programmatically_generating/">Programmatically Generating and Scripting Systems</a></li><li><a class="tocitem" href="../stochastic_diffeq/">Modeling with Stochasticity</a></li><li><a class="tocitem" href="../dynamic_optimization/">Solving Dynamic Optimization Problems</a></li><li><a class="tocitem" href="../discrete_system/">(Experimental) Modeling Discrete Systems</a></li><li><a class="tocitem" href="../parameter_identifiability/">Parameter Identifiability in ODE Models</a></li><li><a class="tocitem" href="../change_independent_variable/">Changing the independent variable of ODEs</a></li><li><a class="tocitem" href="../bifurcation_diagram_computation/">Bifurcation Diagrams</a></li><li><a class="tocitem" href="../attractors/">Multi- and Nonlocal- Continuation</a></li><li><a class="tocitem" href="../SampledData/">Clocks and Sampled-Data Systems</a></li><li><a class="tocitem" href="../domain_connections/">Domains</a></li><li class="is-active"><a class="tocitem" href>Callable parameters and interpolating data</a><ul class="internal"><li><a class="tocitem" href="#Callable-parameter-syntax"><span>Callable parameter syntax</span></a></li><li><a class="tocitem" href="#Storage-of-callable-parameters"><span>Storage of callable parameters</span></a></li><li><a class="tocitem" href="#Example-using-interpolations"><span>Example using interpolations</span></a></li></ul></li><li><a class="tocitem" href="../linear_analysis/">Linear Analysis</a></li><li><a class="tocitem" href="../disturbance_modeling/">Disturbance and input modeling modeling</a></li><li><a class="tocitem" href="../fmi/">Importing FMUs</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Basic Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/higher_order/">Automatic Transformation of Nth Order ODEs to 1st Order ODEs</a></li><li><a class="tocitem" href="../../examples/spring_mass/">Component-Based Modeling of a Spring-Mass System</a></li><li><a class="tocitem" href="../../examples/modelingtoolkitize_index_reduction/">Automated Index Reduction of DAEs</a></li><li><a class="tocitem" href="../../examples/remake/">Optimizing through an ODE solve and re-creating MTK Problems</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Advanced Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/tearing_parallelism/">Exposing More Parallelism By Tearing Algebraic Equations in Systems</a></li><li><a class="tocitem" href="../../examples/sparse_jacobians/">Automated Sparse Analytical Jacobians</a></li><li><a class="tocitem" href="../../examples/perturbation/">Symbolic-Numeric Perturbation Theory for ODEs</a></li></ul></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../API/System/">The <code>System</code> type</a></li><li><a class="tocitem" href="../../API/variables/">Symbolic variables and variable metadata</a></li><li><a class="tocitem" href="../../API/model_building/">Model building reference</a></li><li><a class="tocitem" href="../../API/problems/">Building and solving numerical problems</a></li><li><a class="tocitem" href="../../API/dynamic_opt/">Dynamic Optimization Solvers</a></li><li><a class="tocitem" href="../../API/codegen/">Code generation utilities</a></li><li><a class="tocitem" href="../../API/PDESystem/">PDESystem</a></li></ul></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../../basics/Composition/">Composing Models and Building Reusable Components</a></li><li><a class="tocitem" href="../../basics/Events/">Event Handling and Callback Functions</a></li><li><a class="tocitem" href="../../basics/Linearization/">Linearization</a></li><li><a class="tocitem" href="../../basics/InputOutput/">Input output</a></li><li><a class="tocitem" href="../../basics/MTKLanguage/">ModelingToolkit Language: Modeling with <code>@mtkmodel</code>, <code>@connectors</code> and <code>@mtkcompile</code></a></li><li><a class="tocitem" href="../../basics/Validation/">Model Validation and Units</a></li><li><a class="tocitem" href="../../basics/Debugging/">Debugging</a></li><li><a class="tocitem" href="../../basics/DependencyGraphs/">Dependency Graphs</a></li><li><a class="tocitem" href="../../basics/Precompilation/">Working with Precompilation and Binary Building</a></li><li><a class="tocitem" href="../../basics/FAQ/">Frequently Asked Questions</a></li></ul></li><li><a class="tocitem" href="../../comparison/">Comparison of ModelingToolkit vs Equation-Based and Block Modeling Languages</a></li><li><a class="tocitem" href="../../internals/">Internal Details</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Callable parameters and interpolating data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Callable parameters and interpolating data</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/ModelingToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/ModelingToolkit.jl/blob/master/docs/src/tutorials/callable_params.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Callable-parameters-and-interpolating-data"><a class="docs-heading-anchor" href="#Callable-parameters-and-interpolating-data">Callable parameters and interpolating data</a><a id="Callable-parameters-and-interpolating-data-1"></a><a class="docs-heading-anchor-permalink" href="#Callable-parameters-and-interpolating-data" title="Permalink"></a></h1><p>ModelingToolkit.jl allows creating parameters that represent functions to be called. This is especially useful for including interpolants and/or lookup tables inside ODEs. In this tutorial we will create an <code>System</code> which employs callable parameters to interpolate data inside an ODE and go over the various syntax options and their implications.</p><h2 id="Callable-parameter-syntax"><a class="docs-heading-anchor" href="#Callable-parameter-syntax">Callable parameter syntax</a><a id="Callable-parameter-syntax-1"></a><a class="docs-heading-anchor-permalink" href="#Callable-parameter-syntax" title="Permalink"></a></h2><p>The syntax for callable parameters declared via <code>@parameters</code> must be one of the following</p><ol><li><code>(fn::FType)(..)</code></li><li><code>fn(::argType1, ::argType2, ...)</code></li></ol><p>In the first case, the parameter is callable with any number/combination of arguments, and has a type of <code>FType</code> (the callable must be a subtype of <code>FType</code>). In the second case, the parameter is callable with as many arguments as declared, and all must match the declared types.</p><p>By default, the return type of the callable symbolic is inferred to be <code>Real</code>. To change this, a <code>::retType</code> annotation can be added at the end.</p><p>To declare a function that returns an array of values, the same array syntax can be used as for normal variables:</p><pre><code class="language-julia hljs">@parameters (foo::FType)(..)[1:3]::retType
@parameters foo(::argType1, ::argType2)[1:3]::retType</code></pre><p><code>retType</code> here is the <code>eltype</code> of the returned array.</p><h2 id="Storage-of-callable-parameters"><a class="docs-heading-anchor" href="#Storage-of-callable-parameters">Storage of callable parameters</a><a id="Storage-of-callable-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Storage-of-callable-parameters" title="Permalink"></a></h2><p>Callable parameters declared with the <code>::FType</code> syntax will be stored in a <code>Vector{FType}</code>. Thus, if <code>FType</code> is non-concrete, the buffer will also be non-concrete. This is sometimes necessary to allow the value of the callable to be switched out for a different type without rebuilding the model. Typically this syntax is preferable when <code>FType</code> is concrete or a small union.</p><p>Callable parameters declared with the <code>::argType1, ...</code> syntax will be stored in a <code>Vector{FunctionWrappers.FunctionWrapper{retType, Tuple{argType1, ...}}}</code>. This suffers the small overhead of a <code>FunctionWrapper</code> and restricts the signature of the callable, symbolic, but allows storing the parameter in a type-stable manner and swapping it out. This is preferable when the values that the callable can take do not share a common subtype. For example, when a callable can represent the activation of a neural network and can be <code>tanh</code>, <code>sigmoid</code>, etc. which have a common ancestor of <code>Function</code>.</p><p>If both <code>::FType</code> and <code>::argType</code>s are specified, <code>::FType</code> takes priority. For example,</p><pre><code class="language-julia hljs">@parameters (p::LinearInterpolation)(::Real)</code></pre><p><code>p</code> will be stored in a <code>Vector{LinearInterpolation}</code>. If <code>::LinearInterpolation</code> was not specified, it would be stored in a <code>Vector{FunctionWrapper{Real, Tuple{Real}}}</code>.</p><h2 id="Example-using-interpolations"><a class="docs-heading-anchor" href="#Example-using-interpolations">Example using interpolations</a><a id="Example-using-interpolations-1"></a><a class="docs-heading-anchor-permalink" href="#Example-using-interpolations" title="Permalink"></a></h2><pre><code class="language-julia hljs">using ModelingToolkit
using OrdinaryDiffEq
using DataInterpolations
using ModelingToolkit: t_nounits as t, D_nounits as D

ts = collect(0.0:0.1:10.0)
spline = LinearInterpolation(ts .^ 2, ts)
Tspline = typeof(spline)
@variables x(t)
@parameters (interp::Tspline)(..)

@mtkcompile sys = System(D(x) ~ interp(t), t)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} x\left( t \right)}{\mathrm{d}t} &amp;= \mathtt{interp}\left( t \right)
\end{align}
 \]</p><p>The derivative of <code>x</code> is obtained via an interpolation from DataInterpolations.jl. Note the parameter syntax. The <code>(..)</code> marks the parameter as callable. <code>(interp::Tspline)</code> indicates that the parameter is of type <code>Tspline</code>.</p><pre><code class="language-julia hljs">prob = ODEProblem(sys, [x =&gt; 0.0, interp =&gt; spline], (0.0, 1.0))
solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: 3rd order Hermite
t: 11-element Vector{Float64}:
 0.0
 9.999999999999999e-5
 0.0010999999999999998
 0.011099999999999997
 0.08871574540031633
 0.37471818442706256
 0.5006966920204705
 0.6403305244573025
 0.8056953224055718
 0.9512859886829502
 1.0
u: 11-element Vector{Vector{Float64}}:
 [0.0]
 [4.999999999999996e-10]
 [6.05e-8]
 [6.160499999999991e-6]
 [0.0003935241740966876]
 [0.018157357136368037]
 [0.04269272404953991]
 [0.08861628894870739]
 [0.17582100258715175]
 [0.2887375056076445]
 [0.3351971147710265]</code></pre><p>Note that the the following will not work:</p><pre><code class="language-julia hljs">ODEProblem(
    sys; [x =&gt; 0.0, interp =&gt; LinearInterpolation(0.0:0.1:1.0, 0.0:0.1:1.0)], (0.0, 1.0))</code></pre><p>Since the type of the spline doesn&#39;t match.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../domain_connections/">« Domains</a><a class="docs-footer-nextpage" href="../linear_analysis/">Linear Analysis »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Thursday 19 June 2025 09:39">Thursday 19 June 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
