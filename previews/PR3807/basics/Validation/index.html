<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model Validation and Units · ModelingToolkit.jl</title><meta name="title" content="Model Validation and Units · ModelingToolkit.jl"/><meta property="og:title" content="Model Validation and Units · ModelingToolkit.jl"/><meta property="twitter:title" content="Model Validation and Units · ModelingToolkit.jl"/><meta name="description" content="Documentation for ModelingToolkit.jl."/><meta property="og:description" content="Documentation for ModelingToolkit.jl."/><meta property="twitter:description" content="Documentation for ModelingToolkit.jl."/><meta property="og:url" content="https://docs.sciml.ai/ModelingToolkit/stable/basics/Validation/"/><meta property="twitter:url" content="https://docs.sciml.ai/ModelingToolkit/stable/basics/Validation/"/><link rel="canonical" href="https://docs.sciml.ai/ModelingToolkit/stable/basics/Validation/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ModelingToolkit.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ModelingToolkit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../tutorials/ode_modeling/">Getting Started with ModelingToolkit.jl</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/acausal_components/">Acausal Component-Based Modeling</a></li><li><a class="tocitem" href="../../tutorials/nonlinear/">Modeling Nonlinear Systems</a></li><li><a class="tocitem" href="../../tutorials/initialization/">Initialization of Systems</a></li><li><a class="tocitem" href="../../tutorials/optimization/">Modeling Optimization Problems</a></li><li><a class="tocitem" href="../../tutorials/modelingtoolkitize/">Modelingtoolkitize: Automatically Translating Numerical to Symbolic Code</a></li><li><a class="tocitem" href="../../tutorials/programmatically_generating/">Programmatically Generating and Scripting Systems</a></li><li><a class="tocitem" href="../../tutorials/stochastic_diffeq/">Modeling with Stochasticity</a></li><li><a class="tocitem" href="../../tutorials/dynamic_optimization/">Solving Dynamic Optimization Problems</a></li><li><a class="tocitem" href="../../tutorials/discrete_system/">(Experimental) Modeling Discrete Systems</a></li><li><a class="tocitem" href="../../tutorials/parameter_identifiability/">Parameter Identifiability in ODE Models</a></li><li><a class="tocitem" href="../../tutorials/change_independent_variable/">Changing the independent variable of ODEs</a></li><li><a class="tocitem" href="../../tutorials/bifurcation_diagram_computation/">Bifurcation Diagrams</a></li><li><a class="tocitem" href="../../tutorials/attractors/">Multi- and Nonlocal- Continuation</a></li><li><a class="tocitem" href="../../tutorials/SampledData/">Clocks and Sampled-Data Systems</a></li><li><a class="tocitem" href="../../tutorials/domain_connections/">Domains</a></li><li><a class="tocitem" href="../../tutorials/callable_params/">Callable parameters and interpolating data</a></li><li><a class="tocitem" href="../../tutorials/linear_analysis/">Linear Analysis</a></li><li><a class="tocitem" href="../../tutorials/disturbance_modeling/">Disturbance and input modeling modeling</a></li><li><a class="tocitem" href="../../tutorials/fmi/">Importing FMUs</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Basic Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/higher_order/">Automatic Transformation of Nth Order ODEs to 1st Order ODEs</a></li><li><a class="tocitem" href="../../examples/spring_mass/">Component-Based Modeling of a Spring-Mass System</a></li><li><a class="tocitem" href="../../examples/modelingtoolkitize_index_reduction/">Automated Index Reduction of DAEs</a></li><li><a class="tocitem" href="../../examples/remake/">Optimizing through an ODE solve and re-creating MTK Problems</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Advanced Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/tearing_parallelism/">Exposing More Parallelism By Tearing Algebraic Equations in Systems</a></li><li><a class="tocitem" href="../../examples/sparse_jacobians/">Automated Sparse Analytical Jacobians</a></li><li><a class="tocitem" href="../../examples/perturbation/">Symbolic-Numeric Perturbation Theory for ODEs</a></li></ul></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../API/System/">The <code>System</code> type</a></li><li><a class="tocitem" href="../../API/variables/">Symbolic variables and variable metadata</a></li><li><a class="tocitem" href="../../API/model_building/">Model building reference</a></li><li><a class="tocitem" href="../../API/problems/">Building and solving numerical problems</a></li><li><a class="tocitem" href="../../API/dynamic_opt/">Dynamic Optimization Solvers</a></li><li><a class="tocitem" href="../../API/codegen/">Code generation utilities</a></li><li><a class="tocitem" href="../../API/PDESystem/">PDESystem</a></li></ul></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../Composition/">Composing Models and Building Reusable Components</a></li><li><a class="tocitem" href="../Events/">Event Handling and Callback Functions</a></li><li><a class="tocitem" href="../Linearization/">Linearization</a></li><li><a class="tocitem" href="../InputOutput/">Input output</a></li><li><a class="tocitem" href="../MTKLanguage/">ModelingToolkit Language: Modeling with <code>@mtkmodel</code>, <code>@connectors</code> and <code>@mtkcompile</code></a></li><li class="is-active"><a class="tocitem" href>Model Validation and Units</a><ul class="internal"><li><a class="tocitem" href="#Assigning-Units"><span>Assigning Units</span></a></li><li><a class="tocitem" href="#Unit-Validation-and-Inspection"><span>Unit Validation &amp; Inspection</span></a></li><li><a class="tocitem" href="#User-Defined-Registered-Functions-and-Types"><span>User-Defined Registered Functions and Types</span></a></li><li><a class="tocitem" href="#DynamicQuantities-Literals"><span><code>DynamicQuantities</code> Literals</span></a></li><li><a class="tocitem" href="#Other-Restrictions"><span>Other Restrictions</span></a></li><li><a class="tocitem" href="#Troubleshooting-and-Gotchas"><span>Troubleshooting &amp; Gotchas</span></a></li><li><a class="tocitem" href="#Parameter-and-Initial-Condition-Values"><span>Parameter &amp; Initial Condition Values</span></a></li></ul></li><li><a class="tocitem" href="../Debugging/">Debugging</a></li><li><a class="tocitem" href="../DependencyGraphs/">Dependency Graphs</a></li><li><a class="tocitem" href="../Precompilation/">Working with Precompilation and Binary Building</a></li><li><a class="tocitem" href="../FAQ/">Frequently Asked Questions</a></li></ul></li><li><a class="tocitem" href="../../comparison/">Comparison of ModelingToolkit vs Equation-Based and Block Modeling Languages</a></li><li><a class="tocitem" href="../../internals/">Internal Details</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Basics</a></li><li class="is-active"><a href>Model Validation and Units</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model Validation and Units</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/ModelingToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/ModelingToolkit.jl/blob/master/docs/src/basics/Validation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="units"><a class="docs-heading-anchor" href="#units">Model Validation and Units</a><a id="units-1"></a><a class="docs-heading-anchor-permalink" href="#units" title="Permalink"></a></h1><p>ModelingToolkit.jl provides extensive functionality for model validation and unit checking. This is done by providing metadata to the variable types and then running the validation functions which identify malformed systems and non-physical equations. This approach provides high performance and compatibility with numerical solvers.</p><h2 id="Assigning-Units"><a class="docs-heading-anchor" href="#Assigning-Units">Assigning Units</a><a id="Assigning-Units-1"></a><a class="docs-heading-anchor-permalink" href="#Assigning-Units" title="Permalink"></a></h2><p>Units may be assigned with the following syntax.</p><pre><code class="language-julia hljs">using ModelingToolkit, DynamicQuantities
@independent_variables t [unit = u&quot;s&quot;]
@variables x(t) [unit = u&quot;m&quot;] g(t) w(t) [unit = u&quot;Hz&quot;]

@parameters(t, [unit = u&quot;s&quot;])
@variables(x(t), [unit = u&quot;m&quot;], g(t), w(t), [unit = u&quot;Hz&quot;])

@parameters begin
    t, [unit = u&quot;s&quot;]
end
@variables(begin
    x(t), [unit = u&quot;m&quot;],
    g(t),
    w(t), [unit = u&quot;Hz&quot;]
end)

# Simultaneously set default value (use plain numbers, not quantities)
@variables x=10 [unit = u&quot;m&quot;]

# Symbolic array: unit applies to all elements
@variables x[1:3] [unit = u&quot;m&quot;]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Symbolics.Arr{Num, 1}}:
 x[1:3]</code></pre><p>Do not use <code>quantities</code> such as  <code>1u&quot;s&quot;</code>, <code>1/u&quot;s&quot;</code> or <code>u&quot;1/s&quot;</code> as these will result in errors; instead use <code>u&quot;s&quot;</code>, <code>u&quot;s^-1&quot;</code>, or <code>u&quot;s&quot;^-1</code>.</p><h2 id="Unit-Validation-and-Inspection"><a class="docs-heading-anchor" href="#Unit-Validation-and-Inspection">Unit Validation &amp; Inspection</a><a id="Unit-Validation-and-Inspection-1"></a><a class="docs-heading-anchor-permalink" href="#Unit-Validation-and-Inspection" title="Permalink"></a></h2><p>Unit validation of equations happens automatically when creating a system. However, for debugging purposes, one may wish to validate the equations directly using <code>validate</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelingToolkit.validate" href="#ModelingToolkit.validate"><code>ModelingToolkit.validate</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Returns true iff units of equations are valid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/ModelingToolkit.jl/blob/06e7cd5bc7438fb0ed3bb14475c485ae05157359/src/systems/unit_check.jl#L295-L297">source</a></section></article><p>Inside, <code>validate</code> uses <code>get_unit</code>, which may be directly applied to any term. Note that <code>validate</code> will not throw an error in the event of incompatible units, but <code>get_unit</code> will. If you would rather receive a warning instead of an error, use <code>safe_get_unit</code> which will yield <code>nothing</code> in the event of an error. Unit agreement is tested with <code>ModelingToolkit.equivalent(u1,u2)</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelingToolkit.get_unit" href="#ModelingToolkit.get_unit"><code>ModelingToolkit.get_unit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find the unit of a symbolic item.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/ModelingToolkit.jl/blob/06e7cd5bc7438fb0ed3bb14475c485ae05157359/src/systems/unit_check.jl#L65-L67">source</a></section></article><p>Example usage below. Note that <code>ModelingToolkit</code> does not force unit conversions to preferred units in the event of nonstandard combinations – it merely checks that the equations are consistent.</p><pre><code class="language-julia hljs">using ModelingToolkit, DynamicQuantities
@independent_variables t [unit = u&quot;ms&quot;]
@parameters τ [unit = u&quot;ms&quot;]
@variables E(t) [unit = u&quot;kJ&quot;] P(t) [unit = u&quot;MW&quot;]
D = Differential(t)
eqs = [D(E) ~ P - E / τ,
    0 ~ P]
ModelingToolkit.validate(eqs)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><pre><code class="language-julia hljs">ModelingToolkit.validate(eqs[1])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><pre><code class="language-julia hljs">try
    ModelingToolkit.get_unit(eqs[1].rhs)
catch e
    showerror(stdout, e)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ModelingToolkit.ValidationError(&quot;, in sum P(t) + (-E(t)) / τ, units [1.0e6 m² kg s⁻³, 1.0 m² kg s⁻³] do not match.&quot;)</code></pre><p>An example of an inconsistent system: at present, <code>ModelingToolkit</code> requires that the units of all terms in an equation or sum to be equal-valued (<code>ModelingToolkit.equivalent(u1,u2)</code>), rather than simply dimensionally consistent. In the future, the validation stage may be upgraded to support the insertion of conversion factors into the equations.</p><pre><code class="language-julia hljs">using ModelingToolkit, DynamicQuantities
@independent_variables t [unit = u&quot;ms&quot;]
@parameters τ [unit = u&quot;ms&quot;]
@variables E(t) [unit = u&quot;J&quot;] P(t) [unit = u&quot;MW&quot;]
D = Differential(t)
eqs = [D(E) ~ P - E / τ,
    0 ~ P]
ModelingToolkit.validate(eqs) #Returns false while displaying a warning message</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><h2 id="User-Defined-Registered-Functions-and-Types"><a class="docs-heading-anchor" href="#User-Defined-Registered-Functions-and-Types">User-Defined Registered Functions and Types</a><a id="User-Defined-Registered-Functions-and-Types-1"></a><a class="docs-heading-anchor-permalink" href="#User-Defined-Registered-Functions-and-Types" title="Permalink"></a></h2><p>In order to validate user-defined types and <code>register</code>ed functions, specialize <code>get_unit</code>.  Single-parameter calls to <code>get_unit</code> expect an object type, while two-parameter calls expect a function type as the first argument, and a vector of arguments as the second argument.</p><pre><code class="language-julia hljs">using ModelingToolkit, DynamicQuantities
using ModelingToolkit: t_nounits as t, D_nounits as D
# Composite type parameter in registered function
struct NewType
    f::Any
end
@register_symbolic dummycomplex(complex::Num, scalar)
dummycomplex(complex, scalar) = complex.f - scalar

c = NewType(1)
ModelingToolkit.get_unit(x::NewType) = ModelingToolkit.get_unit(x.f)
function ModelingToolkit.get_unit(op::typeof(dummycomplex), args)
    argunits = ModelingToolkit.get_unit.(args)
    ModelingToolkit.get_unit(-, args)
end

sts = @variables a(t)=0 [unit = u&quot;cm&quot;]
ps = @parameters s=-1 [unit=u&quot;cm&quot;] c=c [unit=u&quot;cm&quot;]
eqs = [D(a) ~ dummycomplex(c, s);]
sys = System(
    eqs, t, [sts...;], [ps...;], name = :sys, checks = ~ModelingToolkit.CheckUnits)
sys_simple = mtkcompile(sys)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} a\left( t \right)}{\mathrm{d}t} &amp;= dummycomplex\left( c, s \right)
\end{align}
 \]</p><h2 id="DynamicQuantities-Literals"><a class="docs-heading-anchor" href="#DynamicQuantities-Literals"><code>DynamicQuantities</code> Literals</a><a id="DynamicQuantities-Literals-1"></a><a class="docs-heading-anchor-permalink" href="#DynamicQuantities-Literals" title="Permalink"></a></h2><p>In order for a function to work correctly during both validation &amp; execution, the function must be unit-agnostic. That is, no unitful literals may be used. Any unitful quantity must either be a <code>parameter</code> or <code>variable</code>. For example, these equations will not validate successfully.</p><pre><code class="language-julia hljs">using ModelingToolkit, DynamicQuantities
@independent_variables t [unit = u&quot;ms&quot;]
@variables E(t) [unit = u&quot;J&quot;] P(t) [unit = u&quot;MW&quot;]
D = Differential(t)
eqs = [D(E) ~ P - E / 1u&quot;ms&quot;]
ModelingToolkit.validate(eqs) #Returns false while displaying a warning message

myfunc(E) = E / 1u&quot;ms&quot;
eqs = [D(E) ~ P - myfunc(E)]
ModelingToolkit.validate(eqs) #Returns false while displaying a warning message</code></pre><p>Instead, they should be parameterized:</p><pre><code class="language-julia hljs">using ModelingToolkit, DynamicQuantities
@independent_variables t [unit = u&quot;ms&quot;]
@parameters τ [unit = u&quot;ms&quot;]
@variables E(t) [unit = u&quot;kJ&quot;] P(t) [unit = u&quot;MW&quot;]
D = Differential(t)
eqs = [D(E) ~ P - E / τ]
ModelingToolkit.validate(eqs) #Returns true</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><pre><code class="language-julia hljs">myfunc(E, τ) = E / τ
eqs = [D(E) ~ P - myfunc(E, τ)]
ModelingToolkit.validate(eqs) #Returns true</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><p>It is recommended <em>not</em> to circumvent unit validation by specializing user-defined functions on <code>DynamicQuantities</code> arguments vs. <code>Numbers</code>. This both fails to take advantage of <code>validate</code> for ensuring correctness, and may cause in errors in the future when <code>ModelingToolkit</code> is extended to support eliminating <code>DynamicQuantities</code> literals from functions.</p><h2 id="Other-Restrictions"><a class="docs-heading-anchor" href="#Other-Restrictions">Other Restrictions</a><a id="Other-Restrictions-1"></a><a class="docs-heading-anchor-permalink" href="#Other-Restrictions" title="Permalink"></a></h2><p><code>Unitful</code> provides non-scalar units such as <code>dBm</code>, <code>°C</code>, etc. At this time, <code>ModelingToolkit</code> only supports scalar quantities. Additionally, angular degrees (<code>°</code>) are not supported because trigonometric functions will treat plain numerical values as radians, which would lead systems validated using degrees to behave erroneously when being solved.</p><h2 id="Troubleshooting-and-Gotchas"><a class="docs-heading-anchor" href="#Troubleshooting-and-Gotchas">Troubleshooting &amp; Gotchas</a><a id="Troubleshooting-and-Gotchas-1"></a><a class="docs-heading-anchor-permalink" href="#Troubleshooting-and-Gotchas" title="Permalink"></a></h2><p>If a system fails to validate due to unit issues, at least one warning message will appear, including a line number as well as the unit types and expressions that were in conflict. Some system constructors re-order equations before the unit checking can be done, in which case the equation numbers may be inaccurate. The printed expression that the problem resides in is always correctly shown.</p><p>Symbolic exponents for unitful variables <em>are</em> supported (ex: <code>P^γ</code> in thermodynamics). However, this means that <code>ModelingToolkit</code> cannot reduce such expressions to <code>DynamicQuantities.Quantity</code> subtypes at validation time because the exponent value is not available. In this case <code>ModelingToolkit.get_unit</code> is type-unstable, yielding a symbolic result, which can still be checked for symbolic equality with <code>ModelingToolkit.equivalent</code>.</p><h2 id="Parameter-and-Initial-Condition-Values"><a class="docs-heading-anchor" href="#Parameter-and-Initial-Condition-Values">Parameter &amp; Initial Condition Values</a><a id="Parameter-and-Initial-Condition-Values-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-and-Initial-Condition-Values" title="Permalink"></a></h2><p>Parameter and initial condition values are supplied to problem constructors as plain numbers, with the understanding that they have been converted to the appropriate units. This is done for simplicity of interfacing with optimization solvers. Some helper function for dealing with value maps:</p><pre><code class="language-julia hljs">function remove_units(p::Dict)
    Dict(k =&gt; Unitful.ustrip(ModelingToolkit.get_unit(k), v) for (k, v) in p)
end
add_units(p::Dict) = Dict(k =&gt; v * ModelingToolkit.get_unit(k) for (k, v) in p)</code></pre><p>Recommended usage:</p><pre><code class="language-julia hljs">pars = @parameters τ [unit = u&quot;ms&quot;]
p = Dict(τ =&gt; 1u&quot;ms&quot;)
ODEProblem(sys, remove_units(u0), tspan, remove_units(p))</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../MTKLanguage/">« ModelingToolkit Language: Modeling with <code>@mtkmodel</code>, <code>@connectors</code> and <code>@mtkcompile</code></a><a class="docs-footer-nextpage" href="../Debugging/">Debugging »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.0 on <span class="colophon-date" title="Wednesday 9 July 2025 18:55">Wednesday 9 July 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
