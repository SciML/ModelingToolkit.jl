<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Changing the independent variable of ODEs · ModelingToolkit.jl</title><meta name="title" content="Changing the independent variable of ODEs · ModelingToolkit.jl"/><meta property="og:title" content="Changing the independent variable of ODEs · ModelingToolkit.jl"/><meta property="twitter:title" content="Changing the independent variable of ODEs · ModelingToolkit.jl"/><meta name="description" content="Documentation for ModelingToolkit.jl."/><meta property="og:description" content="Documentation for ModelingToolkit.jl."/><meta property="twitter:description" content="Documentation for ModelingToolkit.jl."/><meta property="og:url" content="https://docs.sciml.ai/ModelingToolkit/stable/tutorials/change_independent_variable/"/><meta property="twitter:url" content="https://docs.sciml.ai/ModelingToolkit/stable/tutorials/change_independent_variable/"/><link rel="canonical" href="https://docs.sciml.ai/ModelingToolkit/stable/tutorials/change_independent_variable/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ModelingToolkit.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ModelingToolkit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../ode_modeling/">Getting Started with ModelingToolkit.jl</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../acausal_components/">Acausal Component-Based Modeling</a></li><li><a class="tocitem" href="../nonlinear/">Modeling Nonlinear Systems</a></li><li><a class="tocitem" href="../initialization/">Initialization of Systems</a></li><li><a class="tocitem" href="../optimization/">Modeling Optimization Problems</a></li><li><a class="tocitem" href="../modelingtoolkitize/">Modelingtoolkitize: Automatically Translating Numerical to Symbolic Code</a></li><li><a class="tocitem" href="../programmatically_generating/">Programmatically Generating and Scripting Systems</a></li><li><a class="tocitem" href="../stochastic_diffeq/">Modeling with Stochasticity</a></li><li><a class="tocitem" href="../dynamic_optimization/">Solving Dynamic Optimization Problems</a></li><li><a class="tocitem" href="../discrete_system/">(Experimental) Modeling Discrete Systems</a></li><li><a class="tocitem" href="../parameter_identifiability/">Parameter Identifiability in ODE Models</a></li><li class="is-active"><a class="tocitem" href>Changing the independent variable of ODEs</a><ul class="internal"><li><a class="tocitem" href="#1.-Get-one-dependent-variable-as-a-function-of-another"><span>1. Get one dependent variable as a function of another</span></a></li><li><a class="tocitem" href="#2.-Alleviating-stiffness-by-changing-to-logarithmic-time"><span>2. Alleviating stiffness by changing to logarithmic time</span></a></li></ul></li><li><a class="tocitem" href="../bifurcation_diagram_computation/">Bifurcation Diagrams</a></li><li><a class="tocitem" href="../attractors/">Multi- and Nonlocal- Continuation</a></li><li><a class="tocitem" href="../SampledData/">Clocks and Sampled-Data Systems</a></li><li><a class="tocitem" href="../domain_connections/">Domains</a></li><li><a class="tocitem" href="../callable_params/">Callable parameters and interpolating data</a></li><li><a class="tocitem" href="../linear_analysis/">Linear Analysis</a></li><li><a class="tocitem" href="../disturbance_modeling/">Disturbance and input modeling modeling</a></li><li><a class="tocitem" href="../fmi/">Importing FMUs</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Basic Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/higher_order/">Automatic Transformation of Nth Order ODEs to 1st Order ODEs</a></li><li><a class="tocitem" href="../../examples/spring_mass/">Component-Based Modeling of a Spring-Mass System</a></li><li><a class="tocitem" href="../../examples/modelingtoolkitize_index_reduction/">Automated Index Reduction of DAEs</a></li><li><a class="tocitem" href="../../examples/remake/">Optimizing through an ODE solve and re-creating MTK Problems</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Advanced Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/tearing_parallelism/">Exposing More Parallelism By Tearing Algebraic Equations in Systems</a></li><li><a class="tocitem" href="../../examples/sparse_jacobians/">Automated Sparse Analytical Jacobians</a></li><li><a class="tocitem" href="../../examples/perturbation/">Symbolic-Numeric Perturbation Theory for ODEs</a></li></ul></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../API/System/">The <code>System</code> type</a></li><li><a class="tocitem" href="../../API/variables/">Symbolic variables and variable metadata</a></li><li><a class="tocitem" href="../../API/model_building/">Model building reference</a></li><li><a class="tocitem" href="../../API/problems/">Building and solving numerical problems</a></li><li><a class="tocitem" href="../../API/dynamic_opt/">Dynamic Optimization Solvers</a></li><li><a class="tocitem" href="../../API/codegen/">Code generation utilities</a></li><li><a class="tocitem" href="../../API/PDESystem/">PDESystem</a></li></ul></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../../basics/Composition/">Composing Models and Building Reusable Components</a></li><li><a class="tocitem" href="../../basics/Events/">Event Handling and Callback Functions</a></li><li><a class="tocitem" href="../../basics/Linearization/">Linearization</a></li><li><a class="tocitem" href="../../basics/InputOutput/">Input output</a></li><li><a class="tocitem" href="../../basics/MTKLanguage/">ModelingToolkit Language: Modeling with <code>@mtkmodel</code>, <code>@connectors</code> and <code>@mtkcompile</code></a></li><li><a class="tocitem" href="../../basics/Validation/">Model Validation and Units</a></li><li><a class="tocitem" href="../../basics/Debugging/">Debugging</a></li><li><a class="tocitem" href="../../basics/DependencyGraphs/">Dependency Graphs</a></li><li><a class="tocitem" href="../../basics/Precompilation/">Working with Precompilation and Binary Building</a></li><li><a class="tocitem" href="../../basics/FAQ/">Frequently Asked Questions</a></li></ul></li><li><a class="tocitem" href="../../comparison/">Comparison of ModelingToolkit vs Equation-Based and Block Modeling Languages</a></li><li><span class="tocitem">Internal Details</span><ul><li><a class="tocitem" href="../../internals/">Internal Details</a></li><li><a class="tocitem" href="../../internals/structural_transformation/">Structural Transformation</a></li><li><a class="tocitem" href="../../internals/bipartite_graph/">Bipartite Graphs</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Changing the independent variable of ODEs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Changing the independent variable of ODEs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/ModelingToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/ModelingToolkit.jl/blob/master/docs/src/tutorials/change_independent_variable.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Changing-the-independent-variable-of-ODEs"><a class="docs-heading-anchor" href="#Changing-the-independent-variable-of-ODEs">Changing the independent variable of ODEs</a><a id="Changing-the-independent-variable-of-ODEs-1"></a><a class="docs-heading-anchor-permalink" href="#Changing-the-independent-variable-of-ODEs" title="Permalink"></a></h1><p>Ordinary differential equations describe the rate of change of some dependent variables with respect to one independent variable. For the modeler it is often most natural to write down the equations with a particular independent variable, say time <span>$t$</span>. However, in many cases there are good reasons for changing the independent variable:</p><ol><li><p>One may want <span>$y(x)$</span> as a function of <span>$x$</span> instead of <span>$(x(t), y(t))$</span> as a function of <span>$t$</span></p></li><li><p>Some differential equations vary more nicely (e.g. less stiff) with respect to one independent variable than another.</p></li><li><p>It can reduce the number of equations that must be solved (e.g. <span>$y(x)$</span> is one equation, while <span>$(x(t), y(t))$</span> are two).</p></li></ol><p>To manually change the independent variable of an ODE, one must rewrite all equations in terms of a new variable and transform differentials with the chain rule. This is mechanical and error-prone. ModelingToolkit provides the utility function <a href="../../API/model_building/#ModelingToolkit.change_independent_variable"><code>change_independent_variable</code></a> that automates this process.</p><h2 id="1.-Get-one-dependent-variable-as-a-function-of-another"><a class="docs-heading-anchor" href="#1.-Get-one-dependent-variable-as-a-function-of-another">1. Get one dependent variable as a function of another</a><a id="1.-Get-one-dependent-variable-as-a-function-of-another-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Get-one-dependent-variable-as-a-function-of-another" title="Permalink"></a></h2><p>Consider a projectile shot with some initial velocity in a vertical gravitational field with constant horizontal velocity.</p><pre><code class="language-julia hljs">using ModelingToolkit
using ModelingToolkit: t_nounits as t, D_nounits as D
@variables x(t) y(t)
@parameters g=9.81 v # gravitational acceleration and horizontal velocity
eqs = [D(D(y)) ~ -g, D(x) ~ v]
initialization_eqs = [D(x) ~ D(y)] # 45° initial angle
M1 = System(eqs, t; initialization_eqs, name = :M)
M1s = mtkcompile(M1)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} x\left( t \right)}{\mathrm{d}t} &amp;= v \\
\frac{\mathrm{d} y\left( t \right)}{\mathrm{d}t} &amp;= \mathtt{yˍt}\left( t \right) \\
\frac{\mathrm{d} \mathtt{yˍt}\left( t \right)}{\mathrm{d}t} &amp;=  - g
\end{align}
 \]</p><p>This is the standard parametrization that arises naturally from kinematics and Newton&#39;s laws. It expresses the position <span>$(x(t), y(t))$</span> as a function of time <span>$t$</span>. But suppose we want to determine whether the projectile hits a target 10 meters away. There are at least three ways of answering this:</p><ul><li>Solve the ODE for <span>$(x(t), y(t))$</span> and use a callback to terminate when <span>$x$</span> reaches 10 meters, and evaluate <span>$y$</span> at the final time.</li><li>Solve the ODE for <span>$(x(t), y(t))$</span> and use root finding to find the time when <span>$x$</span> reaches 10 meters, and evaluate <span>$y$</span> at that time.</li><li>Solve the ODE for <span>$y(x)$</span> and evaluate it at 10 meters.</li></ul><p>We will demonstrate the last method by changing the independent variable from <span>$t$</span> to <span>$x$</span>. This transformation is well-defined for any non-zero horizontal velocity <span>$v$</span>, so <span>$x$</span> and <span>$t$</span> are one-to-one.</p><pre><code class="language-julia hljs">M2 = change_independent_variable(M1, x)
M2s = mtkcompile(M2; allow_symbolic = true)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} y\left( x \right)}{\mathrm{d}x} &amp;= \mathtt{yˍx}\left( x \right) \\
\frac{\mathrm{d} \mathtt{yˍx}\left( x \right)}{\mathrm{d}x} &amp;= \frac{g + \mathtt{yˍx}\left( x \right) \mathtt{xˍt}\left( x \right) \mathtt{xˍtx}\left( x \right)}{ - \left( \mathtt{xˍt}\left( x \right) \right)^{2}}
\end{align}
 \]</p><p>The derivatives are now with respect to the new independent variable <span>$x$</span>, which can be accessed with <code>M2.x</code>.</p><div class="admonition is-info" id="Info-cd9f430259bf9c0b"><header class="admonition-header">Info<a class="admonition-anchor" href="#Info-cd9f430259bf9c0b" title="Permalink"></a></header><div class="admonition-body"><p>At this point <code>x</code>, <code>M1.x</code>, <code>M1s.x</code>, <code>M2.x</code>, <code>M2s.x</code> are <em>three</em> different variables. Meanwhile <code>y</code>, <code>M1.y</code>, <code>M1s.y</code>, <code>M2.y</code> and <code>M2s.y</code> are <em>four</em> different variables. It can be instructive to inspect these yourself to see their subtle differences.</p></div></div><p>Notice how the number of equations has also decreased from three to two, as <span>$\mathrm{d}x/\mathrm{d}t$</span> has been turned into an observed equation. It is straightforward to evolve the ODE for 10 meters and plot the resulting trajectory <span>$y(x)$</span>:</p><pre><code class="language-julia hljs">using OrdinaryDiffEq, Plots
prob = ODEProblem(M2s, [M2s.y =&gt; 0.0, v =&gt; 8.0], [0.0, 10.0]) # throw 10 meters
sol = solve(prob, Tsit5())
plot(sol; idxs = M2.y) # must index by M2.y = y(x); not M1.y = y(t)!</code></pre><img src="3b67c57a.svg" alt="Example block output"/><div class="admonition is-success" id="Usage-tips-42b3fb759bebad2d"><header class="admonition-header">Usage tips<a class="admonition-anchor" href="#Usage-tips-42b3fb759bebad2d" title="Permalink"></a></header><div class="admonition-body"><p>Look up the documentation of <a href="../../API/model_building/#ModelingToolkit.change_independent_variable"><code>change_independent_variable</code></a> for tips on how to use it.</p><p>For example, if you also need <span>$t(x)$</span>, you can tell it to add a differential equation for the old independent variable in terms of the new one using the <a href="https://en.wikipedia.org/wiki/Inverse_function_rule">inverse function rule</a> (here <span>$\mathrm{d}t/\mathrm{d}x = 1 / (\mathrm{d}x/\mathrm{d}t)$</span>). If you know an analytical expression between the independent variables (here <span>$t = x/v$</span>), you can also pass it directly to the function to avoid the extra differential equation.</p></div></div><h2 id="2.-Alleviating-stiffness-by-changing-to-logarithmic-time"><a class="docs-heading-anchor" href="#2.-Alleviating-stiffness-by-changing-to-logarithmic-time">2. Alleviating stiffness by changing to logarithmic time</a><a id="2.-Alleviating-stiffness-by-changing-to-logarithmic-time-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Alleviating-stiffness-by-changing-to-logarithmic-time" title="Permalink"></a></h2><p>In cosmology, the <a href="https://en.wikipedia.org/wiki/Friedmann_equations">Friedmann equations</a> describe the expansion of the universe. In terms of conformal time <span>$t$</span>, they can be written</p><pre><code class="language-julia hljs">@variables a(t) Ω(t)
a = GlobalScope(a) # global var needed by all species
function species(w; kw...)
    eqs = [D(Ω) ~ -3(1 + w) * D(a) / a * Ω]
    return System(eqs, t, [Ω], []; kw...)
end
@named r = species(1 // 3) # radiation
@named m = species(0) # matter
@named Λ = species(-1) # dark energy / cosmological constant
eqs = [Ω ~ r.Ω + m.Ω + Λ.Ω, D(a) ~ √(Ω) * a^2]
initialization_eqs = [Λ.Ω + r.Ω + m.Ω ~ 1]
M1 = System(eqs, t, [Ω, a], []; initialization_eqs, name = :M)
M1 = compose(M1, r, m, Λ)
M1s = mtkcompile(M1)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} \mathtt{\Lambda.\Omega}\left( t \right)}{\mathrm{d}t} &amp;= -0 \\
\frac{\mathrm{d} a\left( t \right)}{\mathrm{d}t} &amp;= \left( a\left( t \right) \right)^{2} \sqrt{\Omega\left( t \right)} \\
\frac{\mathrm{d} \mathtt{r.\Omega}\left( t \right)}{\mathrm{d}t} &amp;=  - 4 \sqrt{\Omega\left( t \right)} a\left( t \right) \mathtt{r.\Omega}\left( t \right) \\
\frac{\mathrm{d} \mathtt{m.\Omega}\left( t \right)}{\mathrm{d}t} &amp;=  - 3 \sqrt{\Omega\left( t \right)} a\left( t \right) \mathtt{m.\Omega}\left( t \right)
\end{align}
 \]</p><p>Of course, we can solve this ODE as it is:</p><pre><code class="language-julia hljs">prob = ODEProblem(M1s, [M1s.a =&gt; 1.0, M1s.r.Ω =&gt; 5e-5, M1s.m.Ω =&gt; 0.3], (0.0, -3.3), [])
sol = solve(prob, Tsit5(); reltol = 1e-5)
plot(sol, idxs = [M1.a, M1.r.Ω / M1.Ω, M1.m.Ω / M1.Ω, M1.Λ.Ω / M1.Ω])</code></pre><img src="c1216af9.svg" alt="Example block output"/><p>But the solver becomes unstable due to stiffness. Also notice the interesting dynamics taking place towards the end of the integration (in the early universe), which gets compressed into a very small time interval. These ODEs would benefit from being defined with respect to a logarithmic &quot;time&quot; that better captures the evolution of the universe through <em>orders of magnitude</em> of time, rather than linear time.</p><p>It is therefore common to write these ODEs in terms of <span>$b = \ln a$</span>. To do this, we will change the independent variable in two stages; first from <span>$t$</span> to <span>$a$</span>, and then from <span>$a$</span> to <span>$b$</span>. Notice that <span>$\mathrm{d}a/\mathrm{d}t &gt; 0$</span> provided that <span>$\Omega &gt; 0$</span>, and <span>$\mathrm{d}b/\mathrm{d}a &gt; 0$</span>, so the transformation is well-defined since <span>$t \leftrightarrow a \leftrightarrow b$</span> are one-to-one. First, we transform from <span>$t$</span> to <span>$a$</span>:</p><pre><code class="language-julia hljs">M2 = change_independent_variable(M1, M1.a)</code></pre><p class="math-container">\[ \begin{align}
\Omega\left( a \right) &amp;= \mathtt{r.\Omega}\left( a \right) + \mathtt{\Lambda.\Omega}\left( a \right) + \mathtt{m.\Omega}\left( a \right) \\
\mathtt{aˍt}\left( a \right) &amp;= a^{2} \sqrt{\Omega\left( a \right)} \\
\mathtt{aˍt}\left( a \right) \frac{\mathrm{d} \mathtt{r.\Omega}\left( a \right)}{\mathrm{d}a} &amp;= \frac{ - 4 \mathtt{aˍt}\left( a \right) \mathtt{r.\Omega}\left( a \right)}{a} \\
\mathtt{aˍt}\left( a \right) \frac{\mathrm{d} \mathtt{m.\Omega}\left( a \right)}{\mathrm{d}a} &amp;= \frac{ - 3 \mathtt{aˍt}\left( a \right) \mathtt{m.\Omega}\left( a \right)}{a} \\
\mathtt{aˍt}\left( a \right) \frac{\mathrm{d} \mathtt{\Lambda.\Omega}\left( a \right)}{\mathrm{d}a} &amp;= 0
\end{align}
 \]</p><p>Unlike the original, notice that this system is <em>non-autonomous</em> because the independent variable <span>$a$</span> appears explicitly in the equations! This means that to change the independent variable from <span>$a$</span> to <span>$b$</span>, we must provide not only the rate of change relation <span>$db(a)/da = \exp(-b)$</span>, but <em>also</em> the equation <span>$a(b) = \exp(b)$</span> so <span>$a$</span> can be eliminated in favor of <span>$b$</span>:</p><pre><code class="language-julia hljs">a = M2.a # get independent variable of M2
Da = Differential(a)
@variables b(a)
M3 = change_independent_variable(M2, b, [Da(b) ~ exp(-b), a ~ exp(b)])</code></pre><p class="math-container">\[ \begin{align}
\Omega\left( b \right) &amp;= \mathtt{\Lambda.\Omega}\left( b \right) + \mathtt{m.\Omega}\left( b \right) + \mathtt{r.\Omega}\left( b \right) \\
\mathtt{aˍt}\left( b \right) &amp;= \left( a\left( b \right) \right)^{2} \sqrt{\Omega\left( b \right)} \\
\mathtt{bˍa}\left( b \right) &amp;= e^{ - b} \\
a\left( b \right) &amp;= e^{b} \\
\mathtt{bˍa}\left( b \right) \frac{\mathrm{d} \mathtt{r.\Omega}\left( b \right)}{\mathrm{d}b} \mathtt{aˍt}\left( b \right) &amp;= \frac{ - 4 \mathtt{r.\Omega}\left( b \right) \mathtt{aˍt}\left( b \right)}{a\left( b \right)} \\
\mathtt{bˍa}\left( b \right) \frac{\mathrm{d} \mathtt{m.\Omega}\left( b \right)}{\mathrm{d}b} \mathtt{aˍt}\left( b \right) &amp;= \frac{ - 3 \mathtt{m.\Omega}\left( b \right) \mathtt{aˍt}\left( b \right)}{a\left( b \right)} \\
\frac{\mathrm{d} \mathtt{\Lambda.\Omega}\left( b \right)}{\mathrm{d}b} \mathtt{bˍa}\left( b \right) \mathtt{aˍt}\left( b \right) &amp;= 0
\end{align}
 \]</p><p>We can now solve and plot the ODE in terms of <span>$b$</span>:</p><pre><code class="language-julia hljs">M3s = mtkcompile(M3; allow_symbolic = true)
prob = ODEProblem(M3s, [M3s.r.Ω =&gt; 5e-5, M3s.m.Ω =&gt; 0.3], (0, -15), [])
sol = solve(prob, Tsit5())
plot(sol, idxs = [M3.r.Ω / M3.Ω, M3.m.Ω / M3.Ω, M3.Λ.Ω / M3.Ω])</code></pre><img src="8c384418.svg" alt="Example block output"/><p>Notice that the variables vary &quot;more nicely&quot; with respect to <span>$b$</span> than <span>$t$</span>, making the solver happier and avoiding numerical problems.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../parameter_identifiability/">« Parameter Identifiability in ODE Models</a><a class="docs-footer-nextpage" href="../bifurcation_diagram_computation/">Bifurcation Diagrams »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 25 August 2025 07:57">Monday 25 August 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
