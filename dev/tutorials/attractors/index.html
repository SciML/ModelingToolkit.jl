<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Multi- and Nonlocal- Continuation · ModelingToolkit.jl</title><meta name="title" content="Multi- and Nonlocal- Continuation · ModelingToolkit.jl"/><meta property="og:title" content="Multi- and Nonlocal- Continuation · ModelingToolkit.jl"/><meta property="twitter:title" content="Multi- and Nonlocal- Continuation · ModelingToolkit.jl"/><meta name="description" content="Documentation for ModelingToolkit.jl."/><meta property="og:description" content="Documentation for ModelingToolkit.jl."/><meta property="twitter:description" content="Documentation for ModelingToolkit.jl."/><meta property="og:url" content="https://docs.sciml.ai/ModelingToolkit/stable/tutorials/attractors/"/><meta property="twitter:url" content="https://docs.sciml.ai/ModelingToolkit/stable/tutorials/attractors/"/><link rel="canonical" href="https://docs.sciml.ai/ModelingToolkit/stable/tutorials/attractors/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ModelingToolkit.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ModelingToolkit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../ode_modeling/">Getting Started with ModelingToolkit.jl</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../acausal_components/">Acausal Component-Based Modeling</a></li><li><a class="tocitem" href="../nonlinear/">Modeling Nonlinear Systems</a></li><li><a class="tocitem" href="../initialization/">Initialization of Systems</a></li><li><a class="tocitem" href="../optimization/">Modeling Optimization Problems</a></li><li><a class="tocitem" href="../modelingtoolkitize/">Modelingtoolkitize: Automatically Translating Numerical to Symbolic Code</a></li><li><a class="tocitem" href="../programmatically_generating/">Programmatically Generating and Scripting Systems</a></li><li><a class="tocitem" href="../stochastic_diffeq/">Modeling with Stochasticity</a></li><li><a class="tocitem" href="../dynamic_optimization/">Solving Dynamic Optimization Problems</a></li><li><a class="tocitem" href="../discrete_system/">(Experimental) Modeling Discrete Systems</a></li><li><a class="tocitem" href="../parameter_identifiability/">Parameter Identifiability in ODE Models</a></li><li><a class="tocitem" href="../change_independent_variable/">Changing the independent variable of ODEs</a></li><li><a class="tocitem" href="../bifurcation_diagram_computation/">Bifurcation Diagrams</a></li><li class="is-active"><a class="tocitem" href>Multi- and Nonlocal- Continuation</a><ul class="internal"><li><a class="tocitem" href="#Creating-the-DynamicalSystem-via-MTK"><span>Creating the <code>DynamicalSystem</code> via MTK</span></a></li><li><a class="tocitem" href="#Finding-all-attractors-in-the-state-space"><span>Finding all attractors in the state space</span></a></li><li><a class="tocitem" href="#Basins-of-attraction"><span>Basins of attraction</span></a></li><li><a class="tocitem" href="#Global-continuation"><span>Global continuation</span></a></li></ul></li><li><a class="tocitem" href="../SampledData/">Clocks and Sampled-Data Systems</a></li><li><a class="tocitem" href="../domain_connections/">Domains</a></li><li><a class="tocitem" href="../callable_params/">Callable parameters and interpolating data</a></li><li><a class="tocitem" href="../linear_analysis/">Linear Analysis</a></li><li><a class="tocitem" href="../disturbance_modeling/">Disturbance and input modeling modeling</a></li><li><a class="tocitem" href="../fmi/">Importing FMUs</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Basic Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/higher_order/">Automatic Transformation of Nth Order ODEs to 1st Order ODEs</a></li><li><a class="tocitem" href="../../examples/spring_mass/">Component-Based Modeling of a Spring-Mass System</a></li><li><a class="tocitem" href="../../examples/modelingtoolkitize_index_reduction/">Automated Index Reduction of DAEs</a></li><li><a class="tocitem" href="../../examples/remake/">Optimizing through an ODE solve and re-creating MTK Problems</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Advanced Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/tearing_parallelism/">Exposing More Parallelism By Tearing Algebraic Equations in Systems</a></li><li><a class="tocitem" href="../../examples/sparse_jacobians/">Automated Sparse Analytical Jacobians</a></li><li><a class="tocitem" href="../../examples/perturbation/">Symbolic-Numeric Perturbation Theory for ODEs</a></li></ul></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../API/System/">The <code>System</code> type</a></li><li><a class="tocitem" href="../../API/variables/">Symbolic variables and variable metadata</a></li><li><a class="tocitem" href="../../API/model_building/">Model building reference</a></li><li><a class="tocitem" href="../../API/problems/">Building and solving numerical problems</a></li><li><a class="tocitem" href="../../API/dynamic_opt/">Dynamic Optimization Solvers</a></li><li><a class="tocitem" href="../../API/codegen/">Code generation utilities</a></li><li><a class="tocitem" href="../../API/PDESystem/">PDESystem</a></li></ul></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../../basics/Composition/">Composing Models and Building Reusable Components</a></li><li><a class="tocitem" href="../../basics/Events/">Event Handling and Callback Functions</a></li><li><a class="tocitem" href="../../basics/Linearization/">Linearization</a></li><li><a class="tocitem" href="../../basics/InputOutput/">Input output</a></li><li><a class="tocitem" href="../../basics/MTKLanguage/">ModelingToolkit Language: Modeling with <code>@mtkmodel</code>, <code>@connectors</code> and <code>@mtkcompile</code></a></li><li><a class="tocitem" href="../../basics/Validation/">Model Validation and Units</a></li><li><a class="tocitem" href="../../basics/Debugging/">Debugging</a></li><li><a class="tocitem" href="../../basics/DependencyGraphs/">Dependency Graphs</a></li><li><a class="tocitem" href="../../basics/Precompilation/">Working with Precompilation and Binary Building</a></li><li><a class="tocitem" href="../../basics/FAQ/">Frequently Asked Questions</a></li></ul></li><li><a class="tocitem" href="../../comparison/">Comparison of ModelingToolkit vs Equation-Based and Block Modeling Languages</a></li><li><a class="tocitem" href="../../internals/">Internal Details</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Multi- and Nonlocal- Continuation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Multi- and Nonlocal- Continuation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/ModelingToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/ModelingToolkit.jl/blob/master/docs/src/tutorials/attractors.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="attractors"><a class="docs-heading-anchor" href="#attractors">Multi- and Nonlocal- Continuation</a><a id="attractors-1"></a><a class="docs-heading-anchor-permalink" href="#attractors" title="Permalink"></a></h1><p>In the tutorial on <a href="../bifurcation_diagram_computation/#bifurcation_diagrams">Bifurcation Diagrams</a> we saw how one can create them by integrating ModelingToolkit.jl with BifurcationKit.jl. This approach is also often called <em>continuation</em> in the broader literature, because in essence we are &quot;continuing&quot; the location of individual un/stable fixed points or limit cycles in a dynamical system across a parameter axis.</p><p>Recently, an alternative continuation framework was proposed that takes a fundamentally different approach to continuation that is particularly suitable for complex systems. This framework is implemented in <a href="https://juliadynamics.github.io/DynamicalSystemsDocs.jl/attractors/stable/">Attractors.jl</a> as part of the DynamicalSystems.jl software library. This new continuation is called <em>global</em> continuation, while the one of BifurcationKit.jl is called <em>local</em> continuation.</p><p>Instead of continuing an individual fixed point or limit cycle, the global continuation finds all attractors of the dynamical system and continues all of them, in parallel, in a single continuation. It distinguishes and labels automatically the different attractors. Hence &quot;multi-&quot; for multiple attractors. Another key difference is that instead of estimating the local (or linear, or Jacobian) stability of the attractors, it estimates various measures of <em>nonlocal</em> stability (e.g, related with the size of the basins of attraction, or the size of a perturbation that would make the dynamical system state converge to an alternative attractor). Hence the &quot;nonlocal-&quot; component. More differences and pros &amp; cons are discussed in the documentation of Attractors.jl.</p><div class="admonition is-info" id="Attractors-and-basins-dba013a7f8cb827a"><header class="admonition-header">Attractors and basins<a class="admonition-anchor" href="#Attractors-and-basins-dba013a7f8cb827a" title="Permalink"></a></header><div class="admonition-body"><p>This tutorial assumes that you have some familiarity with dynamical systems, specifically what are attractors and basins of attraction. If you don&#39;t have this yet, we recommend Chapter 1 of the textbook <a href="https://link.springer.com/book/10.1007/978-3-030-91032-7">Nonlinear Dynamics</a>.</p></div></div><h2 id="Creating-the-DynamicalSystem-via-MTK"><a class="docs-heading-anchor" href="#Creating-the-DynamicalSystem-via-MTK">Creating the <code>DynamicalSystem</code> via MTK</a><a id="Creating-the-DynamicalSystem-via-MTK-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-the-DynamicalSystem-via-MTK" title="Permalink"></a></h2><p>Let&#39;s showcase this framework by modelling a chaotic bistable dynamical system that we define via ModelingToolkit.jl, which will the be casted into a <code>DynamicalSystem</code> type for the DynamicalSystems.jl library. The equations of our system are</p><pre><code class="language-julia hljs">using ModelingToolkit
using ModelingToolkit: t_nounits as t, D_nounits as D

@variables x(t)=-4.0 y(t)=5.0 z(t)=0.0
@parameters a=5.0 b=0.1

eqs = [
    D(x) ~ y - x,
    D(y) ~ -x * z + b * abs(z),
    D(z) ~ x * y - a
]</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} x\left( t \right)}{\mathrm{d}t} &amp;=  - x\left( t \right) + y\left( t \right) \\
\frac{\mathrm{d} y\left( t \right)}{\mathrm{d}t} &amp;= b \left|z\left( t \right)\right| - x\left( t \right) z\left( t \right) \\
\frac{\mathrm{d} z\left( t \right)}{\mathrm{d}t} &amp;=  - a + x\left( t \right) y\left( t \right)
\end{align}
 \]</p><p>Because our dynamical system is super simple, we will directly make an <code>System</code> and cast it in an <code>ODEProblem</code> as in the <a href="../programmatically_generating/#programmatically"><code>Systems</code> tutorial</a>. Since all state variables and parameters have a default value we can immediately write</p><pre><code class="language-julia hljs">@named modlorenz = System(eqs, t)
ssys = mtkcompile(modlorenz)
# The timespan given to the problem is irrelevant for DynamicalSystems.jl
prob = ODEProblem(ssys, [], (0.0, 1.0))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr38_2" style="color:#56b6c2">ODEProblem</span> with uType <span class="sgr38_2" style="color:#56b6c2">Vector{Float64}</span> and tType <span class="sgr38_2" style="color:#56b6c2">Float64</span>. In-place: <span class="sgr38_2" style="color:#56b6c2">true</span>
Initialization status: <span class="sgr38_2" style="color:#56b6c2">FULLY_DETERMINED</span>
Non-trivial mass matrix: <span class="sgr38_2" style="color:#56b6c2">false</span>
timespan: (0.0, 1.0)
u0: 3-element Vector{Float64}:
  0.0
  5.0
 -4.0</code></pre><p>This <code>prob</code> can be turned to a dynamical system as simply as</p><pre><code class="language-julia hljs">using Attractors # or `DynamicalSystems`
ds = CoupledODEs(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-dimensional CoupledODEs
 deterministic: true
 discrete time: false
 in-place:      true
 dynamic rule:  GeneratedFunctionWrapper
 ODE solver:    Tsit5
 ODE kwargs:    (abstol = 1.0e-6, reltol = 1.0e-6)
 parameters:    MTKParameters{Vector{Float64}, Vector{Float64}, Tuple{}, Tuple{}, Tuple{}, Tuple{}}([5.0, 0.1], [0.0, 5.0, -4.0, 0.0, 0.0, 0.0], (), (), (), ())
 time:          0.0
 state:         [0.0, 5.0, -4.0]
</code></pre><p>DynamicalSystems.jl integrates fully with ModelingToolkit.jl out of the box and understands whether a given problem has been created via ModelingToolkit.jl. For example you can use the symbolic variables, or their <code>Symbol</code> representations, to access a system state or parameter</p><pre><code class="language-julia hljs">observe_state(ds, x)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-4.0</code></pre><pre><code class="language-julia hljs">current_parameter(ds, :a) # or `a` directly</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5.0</code></pre><h2 id="Finding-all-attractors-in-the-state-space"><a class="docs-heading-anchor" href="#Finding-all-attractors-in-the-state-space">Finding all attractors in the state space</a><a id="Finding-all-attractors-in-the-state-space-1"></a><a class="docs-heading-anchor-permalink" href="#Finding-all-attractors-in-the-state-space" title="Permalink"></a></h2><p>Attractors.jl provides an extensive interface for finding all (within a state space region and numerical accuracy) attractors of a dynamical system. This interface is structured around the type <code>AttractorMapper</code> and is discussed in the Attractors.jl documentation in detail. Here we will briefly mention one of the possible approaches, the recurrences-based algorithm. It finds attractors by finding locations in the state space where the trajectory returns again and again.</p><p>To use this technique, we first need to create a tessellation of the state space</p><pre><code class="language-julia hljs">grid = (
    range(-15.0, 15.0; length = 150), # x
    range(-20.0, 20.0; length = 150), # y
    range(-20.0, 20.0; length = 150) # z
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(-15.0:0.20134228187919462:15.0, -20.0:0.2684563758389262:20.0, -20.0:0.2684563758389262:20.0)</code></pre><p>which we then give as input to the <code>AttractorsViaRecurrences</code> mapper along with the dynamical system</p><pre><code class="language-julia hljs">mapper = AttractorsViaRecurrences(ds, grid;
    consecutive_recurrences = 1000,
    consecutive_lost_steps = 100
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">AttractorsViaRecurrences
 system:      CoupledODEs
 grid:        (-15.0:0.20134228187919462:15.0, -20.0:0.2684563758389262:20.0, -20.0:0.2684563758389262:20.0)
 attractors:  Dict{Int64, StateSpaceSets.StateSpaceSet{3, Float64, StaticArraysCore.SVector{3, Float64}}}()
</code></pre><p>to learn about the metaparameters of the algorithm visit the documentation of Attractors.jl.</p><p>This <code>mapper</code> object is incredibly powerful! It can be used to map initial conditions to attractor they converge to, while ensuring that initial conditions that converge to the same attractor are given the same label. For example, if we use the <code>mapper</code> as a function and give it an initial condition we get</p><pre><code class="language-julia hljs">mapper([-4.0, 5, 0])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1</code></pre><pre><code class="language-julia hljs">mapper([4.0, 2, 0])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1</code></pre><pre><code class="language-julia hljs">mapper([1.0, 3, 2])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1</code></pre><p>The numbers returned are simply the unique identifiers of the attractors the initial conditions converged to.</p><p>DynamicalSystems.jl library is the only dynamical systems software (in any language) that provides such an infrastructure for mapping initial conditions of any arbitrary dynamical system to its unique attractors. And this is only the tip of this iceberg! The rest of the functionality of Attractors.jl is all full of brand new cutting edge progress in dynamical systems research.</p><p>The found attractors are stored in the mapper internally, to obtain them we use the function</p><pre><code class="language-julia hljs">attractors = extract_attractors(mapper)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Int64, StateSpaceSets.StateSpaceSet{3, Float64, StaticArraysCore.SVector{3, Float64}}} with 1 entry:
  1 =&gt; 3-dimensional StateSpaceSet{Float64} with 740 points</code></pre><p>This is a dictionary that maps attractor IDs to the attractor sets themselves. <code>StateSpaceSet</code> is a wrapper of a vector of points and behaves exactly like a vector of points. We can plot them easily like</p><pre><code class="language-julia hljs">using CairoMakie
fig = Figure()
ax = Axis(fig[1, 1])
colors = [&quot;#7143E0&quot;, &quot;#191E44&quot;]
for (id, A) in attractors
    scatter!(ax, A[:, [1, 3]]; color = colors[id])
end
fig</code></pre><img src="4709021c.png" alt="Example block output"/><h2 id="Basins-of-attraction"><a class="docs-heading-anchor" href="#Basins-of-attraction">Basins of attraction</a><a id="Basins-of-attraction-1"></a><a class="docs-heading-anchor-permalink" href="#Basins-of-attraction" title="Permalink"></a></h2><p>Estimating the basins of attraction of these attractors is a matter of a couple lines of code. First we define the state space are to estimate the basins for. Here we can re-use the <code>grid</code> we defined above. Then we only have to call</p><pre><code class="language-julia hljs">basins = basins_of_attraction(mapper, grid)</code></pre><p>We won&#39;t run this in this tutorial because it is a length computation (150×150×150). We will however estimate a slice of the 3D basins of attraction. DynamicalSystems.jl allows for a rather straightforward setting of initial conditions:</p><pre><code class="language-julia hljs">ics = [Dict(:x =&gt; x, :y =&gt; 0, :z =&gt; z) for x in grid[1] for z in grid[3]]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">22500-element Vector{Dict{Symbol, Real}}:
 Dict(:y =&gt; 0, :z =&gt; -20.0, :x =&gt; -15.0)
 Dict(:y =&gt; 0, :z =&gt; -19.731543624161073, :x =&gt; -15.0)
 Dict(:y =&gt; 0, :z =&gt; -19.463087248322147, :x =&gt; -15.0)
 Dict(:y =&gt; 0, :z =&gt; -19.19463087248322, :x =&gt; -15.0)
 Dict(:y =&gt; 0, :z =&gt; -18.926174496644297, :x =&gt; -15.0)
 Dict(:y =&gt; 0, :z =&gt; -18.65771812080537, :x =&gt; -15.0)
 Dict(:y =&gt; 0, :z =&gt; -18.389261744966444, :x =&gt; -15.0)
 Dict(:y =&gt; 0, :z =&gt; -18.120805369127517, :x =&gt; -15.0)
 Dict(:y =&gt; 0, :z =&gt; -17.85234899328859, :x =&gt; -15.0)
 Dict(:y =&gt; 0, :z =&gt; -17.583892617449663, :x =&gt; -15.0)
 ⋮
 Dict(:y =&gt; 0, :z =&gt; 17.85234899328859, :x =&gt; 15.0)
 Dict(:y =&gt; 0, :z =&gt; 18.120805369127517, :x =&gt; 15.0)
 Dict(:y =&gt; 0, :z =&gt; 18.389261744966444, :x =&gt; 15.0)
 Dict(:y =&gt; 0, :z =&gt; 18.65771812080537, :x =&gt; 15.0)
 Dict(:y =&gt; 0, :z =&gt; 18.926174496644297, :x =&gt; 15.0)
 Dict(:y =&gt; 0, :z =&gt; 19.19463087248322, :x =&gt; 15.0)
 Dict(:y =&gt; 0, :z =&gt; 19.463087248322147, :x =&gt; 15.0)
 Dict(:y =&gt; 0, :z =&gt; 19.731543624161073, :x =&gt; 15.0)
 Dict(:y =&gt; 0, :z =&gt; 20.0, :x =&gt; 15.0)</code></pre><p>now we can estimate the basins of attraction on a slice on the x-z grid</p><pre><code class="language-julia hljs">fs, labels = basins_fractions(mapper, ics)
labels = reshape(labels, (length(grid[1]), length(grid[3])))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">150×150 Matrix{Int64}:
 2  1  1  2  2  1  1  1  2  2  1  2  2  …  1  1  1  1  1  1  1  2  2  2  1  2
 1  1  2  2  1  1  2  2  1  2  1  1  1     1  1  1  1  1  1  1  1  1  2  2  1
 1  2  1  1  1  2  2  1  2  1  2  1  1     1  1  2  1  1  1  2  1  1  1  2  2
 2  1  1  1  2  1  1  1  2  1  1  1  1     2  2  2  2  1  2  1  1  1  1  1  2
 1  1  1  2  1  1  1  1  1  1  2  2  2     1  1  1  1  2  2  1  2  1  2  1  1
 1  1  2  2  2  2  1  1  2  2  1  1  1  …  2  1  1  1  1  1  2  2  1  1  1  1
 1  2  2  1  1  1  1  2  1  1  2  2  1     1  1  1  2  1  1  1  1  2  2  2  1
 2  1  1  1  1  2  1  1  2  1  1  1  2     2  1  1  2  1  1  2  1  1  1  2  1
 1  2  1  1  2  1  1  1  2  2  1  1  1     1  1  2  1  1  1  2  1  1  1  1  2
 2  2  1  2  1  1  1  1  1  1  2  1  1     2  2  1  1  2  1  1  1  1  2  1  1
 ⋮              ⋮              ⋮        ⋱        ⋮              ⋮           
 1  2  1  2  2  2  1  2  2  1  1  1  1     1  2  1  1  1  1  1  1  2  1  1  2
 1  1  1  1  2  1  1  1  2  1  1  1  2     2  1  2  1  2  1  1  2  1  1  1  2
 2  1  2  1  2  2  1  1  1  2  1  1  2     2  2  1  2  2  1  2  2  1  1  1  1
 2  1  2  1  1  2  1  1  1  1  2  1  2     1  2  2  1  1  2  2  1  1  1  1  1
 1  1  1  2  1  2  2  1  1  1  1  1  2  …  1  1  1  1  2  1  2  1  1  1  2  1
 1  2  1  2  1  1  2  1  1  1  1  1  1     1  1  2  2  2  1  1  1  1  2  1  1
 1  1  1  1  1  1  1  2  1  2  2  1  1     2  2  1  2  1  1  1  1  1  1  1  1
 2  1  2  1  2  2  1  1  2  2  1  1  2     1  1  2  1  1  1  1  1  2  2  1  1
 2  1  2  1  1  2  1  1  1  2  2  2  1     1  1  1  1  1  1  2  1  1  1  2  1</code></pre><p>and visualize them</p><pre><code class="language-julia hljs">heatmap(grid[1], grid[3], labels; colormap = colors)</code></pre><img src="8e4c95a4.png" alt="Example block output"/><h2 id="Global-continuation"><a class="docs-heading-anchor" href="#Global-continuation">Global continuation</a><a id="Global-continuation-1"></a><a class="docs-heading-anchor-permalink" href="#Global-continuation" title="Permalink"></a></h2><p>We&#39;ve already outlined the principles of the global continuation, so let&#39;s just do it here! We first have to define a global continuation algorithm, which for this tutorial, it is just a wrapper of the existing <code>mapper</code></p><pre><code class="language-julia hljs">ascm = AttractorSeedContinueMatch(mapper);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Attractors.AttractorSeedContinueMatch{Attractors.AttractorsViaRecurrences{DynamicalSystemsBase.CoupledODEs{true, 3, OrdinaryDiffEqCore.ODEIntegrator{OrdinaryDiffEqTsit5.Tsit5{typeof(OrdinaryDiffEqCore.trivial_limiter!), typeof(OrdinaryDiffEqCore.trivial_limiter!), Static.False}, true, Vector{Float64}, Nothing, Float64, MTKParameters{Vector{Float64}, Vector{Float64}, Tuple{}, Tuple{}, Tuple{}, Tuple{}}, Float64, Float64, Float64, Float64, Vector{Vector{Float64}}, SciMLBase.ODESolution{Float64, 2, Vector{Vector{Float64}}, Nothing, Nothing, Vector{Float64}, Vector{Vector{Vector{Float64}}}, Nothing, ODEProblem{Vector{Float64}, Tuple{Float64, Float64}, true, MTKParameters{Vector{Float64}, Vector{Float64}, Tuple{}, Tuple{}, Tuple{}, Tuple{}}, ODEFunction{true, SciMLBase.FullSpecialize, ModelingToolkit.GeneratedFunctionWrapper{(2, 3, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___, :t), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0xda35cd28, 0x45b85cf8, 0xd03cb7bb, 0x7a1bc610, 0xf393e698), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___, :t), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0xd5b07982, 0xda767672, 0xa58365e9, 0x5613a29a, 0x5053c983), Nothing}}, LinearAlgebra.UniformScaling{Bool}, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, ModelingToolkit.ObservedFunctionCache{System}, Nothing, System, SciMLBase.OverrideInitData{NonlinearProblem{Nothing, true, MTKParameters{Vector{Float64}, StaticArraysCore.SizedVector{0, Float64, Vector{Float64}}, Tuple{}, Tuple{}, Tuple{}, Tuple{}}, NonlinearFunction{true, SciMLBase.FullSpecialize, ModelingToolkit.GeneratedFunctionWrapper{(2, 2, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x05ab34b3, 0xbb83368f, 0xf8d1a763, 0xa8680f9e, 0xcccf1e86), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x5fb51032, 0x46a817ac, 0x8a5b9f05, 0x1bf2fb5e, 0x00f77e4e), Nothing}}, LinearAlgebra.UniformScaling{Bool}, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, ModelingToolkit.ObservedFunctionCache{System}, Nothing, System, Nothing, Nothing}, Base.Pairs{Symbol, Union{}, Tuple{}, @NamedTuple{}}, SciMLBase.StandardNonlinearProblem}, typeof(ModelingToolkit.update_initializeprob!), ComposedFunction{ComposedFunction{typeof(identity), typeof(ModelingToolkit.safe_float)}, SymbolicIndexingInterface.TimeIndependentObservedFunction{ModelingToolkit.GeneratedFunctionWrapper{(2, 2, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0xf07bf105, 0xf57e020b, 0x4c23a0af, 0x109127c1, 0x74411c46), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x4d46708a, 0x4bd9da7c, 0xd33e9056, 0x4802d375, 0x4639cca3), Nothing}}}}, ModelingToolkit.var&quot;#initprobpmap_split#904&quot;{ModelingToolkit.var&quot;#_getter#900&quot;{Tuple{ComposedFunction{ModelingToolkit.PConstructorApplicator{typeof(identity)}, ModelingToolkit.ObservedWrapper{false, ModelingToolkit.GeneratedFunctionWrapper{(2, 2, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x8c32815f, 0x9b91f6bb, 0xca03ca81, 0x1bba391f, 0x88cbc55e), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x4e1270da, 0xab9c3ae6, 0xc279a591, 0x707cdf98, 0x49d87db6), Nothing}}}}, ComposedFunction{ModelingToolkit.PConstructorApplicator{typeof(identity)}, ModelingToolkit.ObservedWrapper{false, ModelingToolkit.GeneratedFunctionWrapper{(2, 2, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x3d235429, 0xe7c698de, 0xde16e567, 0xa141cd27, 0x6d3ee880), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x9000fe69, 0x61b41a89, 0xcd0c06e8, 0xf025b2bd, 0x8cc6fcec), Nothing}}}}, Returns{Tuple{}}, Returns{Tuple{}}, Returns{Tuple{}}}}}, ModelingToolkit.InitializationMetadata{ModelingToolkit.ReconstructInitializeprob{ModelingToolkit.var&quot;#_getter#900&quot;{Tuple{ComposedFunction{ModelingToolkit.PConstructorApplicator{typeof(identity)}, ModelingToolkit.ObservedWrapper{true, ModelingToolkit.GeneratedFunctionWrapper{(2, 3, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___, :t), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x178e811a, 0xf484a170, 0xc50638b7, 0x64e43b6a, 0xb42650ce), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___, :t), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x5e863d51, 0x90dea19f, 0xdf8693ad, 0x064a5599, 0xa0283126), Nothing}}}}, Returns{StaticArraysCore.SizedVector{0, Float64, Vector{Float64}}}, Returns{Tuple{}}, Returns{Tuple{}}, Returns{Tuple{}}}}, ComposedFunction{typeof(identity), SymbolicIndexingInterface.MultipleGetters{SymbolicIndexingInterface.ContinuousTimeseries, Vector{Any}}}}, ModelingToolkit.GetUpdatedU0{SymbolicIndexingInterface.MultipleGetters{SymbolicIndexingInterface.ContinuousTimeseries, Vector{SymbolicUtils.BasicSymbolic{Real}}}, SymbolicIndexingInterface.MultipleParametersGetter{SymbolicIndexingInterface.IndexerNotTimeseries, Vector{SymbolicIndexingInterface.GetParameterIndex{ModelingToolkit.ParameterIndex{SciMLStructures.Initials, Int64}}}, Nothing}}, ModelingToolkit.SetInitialUnknowns{SymbolicIndexingInterface.MultipleSetters{Vector{SymbolicIndexingInterface.ParameterHookWrapper{SymbolicIndexingInterface.SetParameterIndex{ModelingToolkit.ParameterIndex{SciMLStructures.Initials, Int64}}, SymbolicUtils.BasicSymbolic{Real}}}}}}, Val{true}}, Nothing}, Base.Pairs{Symbol, Union{}, Tuple{}, @NamedTuple{}}, SciMLBase.StandardODEProblem}, OrdinaryDiffEqTsit5.Tsit5{typeof(OrdinaryDiffEqCore.trivial_limiter!), typeof(OrdinaryDiffEqCore.trivial_limiter!), Static.False}, OrdinaryDiffEqCore.InterpolationData{ODEFunction{true, SciMLBase.FullSpecialize, ModelingToolkit.GeneratedFunctionWrapper{(2, 3, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___, :t), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0xda35cd28, 0x45b85cf8, 0xd03cb7bb, 0x7a1bc610, 0xf393e698), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___, :t), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0xd5b07982, 0xda767672, 0xa58365e9, 0x5613a29a, 0x5053c983), Nothing}}, LinearAlgebra.UniformScaling{Bool}, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, ModelingToolkit.ObservedFunctionCache{System}, Nothing, System, SciMLBase.OverrideInitData{NonlinearProblem{Nothing, true, MTKParameters{Vector{Float64}, StaticArraysCore.SizedVector{0, Float64, Vector{Float64}}, Tuple{}, Tuple{}, Tuple{}, Tuple{}}, NonlinearFunction{true, SciMLBase.FullSpecialize, ModelingToolkit.GeneratedFunctionWrapper{(2, 2, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x05ab34b3, 0xbb83368f, 0xf8d1a763, 0xa8680f9e, 0xcccf1e86), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x5fb51032, 0x46a817ac, 0x8a5b9f05, 0x1bf2fb5e, 0x00f77e4e), Nothing}}, LinearAlgebra.UniformScaling{Bool}, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, ModelingToolkit.ObservedFunctionCache{System}, Nothing, System, Nothing, Nothing}, Base.Pairs{Symbol, Union{}, Tuple{}, @NamedTuple{}}, SciMLBase.StandardNonlinearProblem}, typeof(ModelingToolkit.update_initializeprob!), ComposedFunction{ComposedFunction{typeof(identity), typeof(ModelingToolkit.safe_float)}, SymbolicIndexingInterface.TimeIndependentObservedFunction{ModelingToolkit.GeneratedFunctionWrapper{(2, 2, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0xf07bf105, 0xf57e020b, 0x4c23a0af, 0x109127c1, 0x74411c46), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x4d46708a, 0x4bd9da7c, 0xd33e9056, 0x4802d375, 0x4639cca3), Nothing}}}}, ModelingToolkit.var&quot;#initprobpmap_split#904&quot;{ModelingToolkit.var&quot;#_getter#900&quot;{Tuple{ComposedFunction{ModelingToolkit.PConstructorApplicator{typeof(identity)}, ModelingToolkit.ObservedWrapper{false, ModelingToolkit.GeneratedFunctionWrapper{(2, 2, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x8c32815f, 0x9b91f6bb, 0xca03ca81, 0x1bba391f, 0x88cbc55e), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x4e1270da, 0xab9c3ae6, 0xc279a591, 0x707cdf98, 0x49d87db6), Nothing}}}}, ComposedFunction{ModelingToolkit.PConstructorApplicator{typeof(identity)}, ModelingToolkit.ObservedWrapper{false, ModelingToolkit.GeneratedFunctionWrapper{(2, 2, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x3d235429, 0xe7c698de, 0xde16e567, 0xa141cd27, 0x6d3ee880), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x9000fe69, 0x61b41a89, 0xcd0c06e8, 0xf025b2bd, 0x8cc6fcec), Nothing}}}}, Returns{Tuple{}}, Returns{Tuple{}}, Returns{Tuple{}}}}}, ModelingToolkit.InitializationMetadata{ModelingToolkit.ReconstructInitializeprob{ModelingToolkit.var&quot;#_getter#900&quot;{Tuple{ComposedFunction{ModelingToolkit.PConstructorApplicator{typeof(identity)}, ModelingToolkit.ObservedWrapper{true, ModelingToolkit.GeneratedFunctionWrapper{(2, 3, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___, :t), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x178e811a, 0xf484a170, 0xc50638b7, 0x64e43b6a, 0xb42650ce), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___, :t), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x5e863d51, 0x90dea19f, 0xdf8693ad, 0x064a5599, 0xa0283126), Nothing}}}}, Returns{StaticArraysCore.SizedVector{0, Float64, Vector{Float64}}}, Returns{Tuple{}}, Returns{Tuple{}}, Returns{Tuple{}}}}, ComposedFunction{typeof(identity), SymbolicIndexingInterface.MultipleGetters{SymbolicIndexingInterface.ContinuousTimeseries, Vector{Any}}}}, ModelingToolkit.GetUpdatedU0{SymbolicIndexingInterface.MultipleGetters{SymbolicIndexingInterface.ContinuousTimeseries, Vector{SymbolicUtils.BasicSymbolic{Real}}}, SymbolicIndexingInterface.MultipleParametersGetter{SymbolicIndexingInterface.IndexerNotTimeseries, Vector{SymbolicIndexingInterface.GetParameterIndex{ModelingToolkit.ParameterIndex{SciMLStructures.Initials, Int64}}}, Nothing}}, ModelingToolkit.SetInitialUnknowns{SymbolicIndexingInterface.MultipleSetters{Vector{SymbolicIndexingInterface.ParameterHookWrapper{SymbolicIndexingInterface.SetParameterIndex{ModelingToolkit.ParameterIndex{SciMLStructures.Initials, Int64}}, SymbolicUtils.BasicSymbolic{Real}}}}}}, Val{true}}, Nothing}, Vector{Vector{Float64}}, Vector{Float64}, Vector{Vector{Vector{Float64}}}, Nothing, OrdinaryDiffEqTsit5.Tsit5Cache{Vector{Float64}, Vector{Float64}, Vector{Float64}, typeof(OrdinaryDiffEqCore.trivial_limiter!), typeof(OrdinaryDiffEqCore.trivial_limiter!), Static.False}, Nothing}, SciMLBase.DEStats, Nothing, Nothing, Nothing, Nothing}, ODEFunction{true, SciMLBase.FullSpecialize, ModelingToolkit.GeneratedFunctionWrapper{(2, 3, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___, :t), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0xda35cd28, 0x45b85cf8, 0xd03cb7bb, 0x7a1bc610, 0xf393e698), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___, :t), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0xd5b07982, 0xda767672, 0xa58365e9, 0x5613a29a, 0x5053c983), Nothing}}, LinearAlgebra.UniformScaling{Bool}, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, ModelingToolkit.ObservedFunctionCache{System}, Nothing, System, SciMLBase.OverrideInitData{NonlinearProblem{Nothing, true, MTKParameters{Vector{Float64}, StaticArraysCore.SizedVector{0, Float64, Vector{Float64}}, Tuple{}, Tuple{}, Tuple{}, Tuple{}}, NonlinearFunction{true, SciMLBase.FullSpecialize, ModelingToolkit.GeneratedFunctionWrapper{(2, 2, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x05ab34b3, 0xbb83368f, 0xf8d1a763, 0xa8680f9e, 0xcccf1e86), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x5fb51032, 0x46a817ac, 0x8a5b9f05, 0x1bf2fb5e, 0x00f77e4e), Nothing}}, LinearAlgebra.UniformScaling{Bool}, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, Nothing, ModelingToolkit.ObservedFunctionCache{System}, Nothing, System, Nothing, Nothing}, Base.Pairs{Symbol, Union{}, Tuple{}, @NamedTuple{}}, SciMLBase.StandardNonlinearProblem}, typeof(ModelingToolkit.update_initializeprob!), ComposedFunction{ComposedFunction{typeof(identity), typeof(ModelingToolkit.safe_float)}, SymbolicIndexingInterface.TimeIndependentObservedFunction{ModelingToolkit.GeneratedFunctionWrapper{(2, 2, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0xf07bf105, 0xf57e020b, 0x4c23a0af, 0x109127c1, 0x74411c46), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x4d46708a, 0x4bd9da7c, 0xd33e9056, 0x4802d375, 0x4639cca3), Nothing}}}}, ModelingToolkit.var&quot;#initprobpmap_split#904&quot;{ModelingToolkit.var&quot;#_getter#900&quot;{Tuple{ComposedFunction{ModelingToolkit.PConstructorApplicator{typeof(identity)}, ModelingToolkit.ObservedWrapper{false, ModelingToolkit.GeneratedFunctionWrapper{(2, 2, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x8c32815f, 0x9b91f6bb, 0xca03ca81, 0x1bba391f, 0x88cbc55e), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x4e1270da, 0xab9c3ae6, 0xc279a591, 0x707cdf98, 0x49d87db6), Nothing}}}}, ComposedFunction{ModelingToolkit.PConstructorApplicator{typeof(identity)}, ModelingToolkit.ObservedWrapper{false, ModelingToolkit.GeneratedFunctionWrapper{(2, 2, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x3d235429, 0xe7c698de, 0xde16e567, 0xa141cd27, 0x6d3ee880), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x9000fe69, 0x61b41a89, 0xcd0c06e8, 0xf025b2bd, 0x8cc6fcec), Nothing}}}}, Returns{Tuple{}}, Returns{Tuple{}}, Returns{Tuple{}}}}}, ModelingToolkit.InitializationMetadata{ModelingToolkit.ReconstructInitializeprob{ModelingToolkit.var&quot;#_getter#900&quot;{Tuple{ComposedFunction{ModelingToolkit.PConstructorApplicator{typeof(identity)}, ModelingToolkit.ObservedWrapper{true, ModelingToolkit.GeneratedFunctionWrapper{(2, 3, true), RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:__mtk_arg_1, :___mtkparameters___, :t), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x178e811a, 0xf484a170, 0xc50638b7, 0x64e43b6a, 0xb42650ce), Nothing}, RuntimeGeneratedFunctions.RuntimeGeneratedFunction{(:ˍ₋out, :__mtk_arg_1, :___mtkparameters___, :t), ModelingToolkit.var&quot;#_RGF_ModTag&quot;, ModelingToolkit.var&quot;#_RGF_ModTag&quot;, (0x5e863d51, 0x90dea19f, 0xdf8693ad, 0x064a5599, 0xa0283126), Nothing}}}}, Returns{StaticArraysCore.SizedVector{0, Float64, Vector{Float64}}}, Returns{Tuple{}}, Returns{Tuple{}}, Returns{Tuple{}}}}, ComposedFunction{typeof(identity), SymbolicIndexingInterface.MultipleGetters{SymbolicIndexingInterface.ContinuousTimeseries, Vector{Any}}}}, ModelingToolkit.GetUpdatedU0{SymbolicIndexingInterface.MultipleGetters{SymbolicIndexingInterface.ContinuousTimeseries, Vector{SymbolicUtils.BasicSymbolic{Real}}}, SymbolicIndexingInterface.MultipleParametersGetter{SymbolicIndexingInterface.IndexerNotTimeseries, Vector{SymbolicIndexingInterface.GetParameterIndex{ModelingToolkit.ParameterIndex{SciMLStructures.Initials, Int64}}}, Nothing}}, ModelingToolkit.SetInitialUnknowns{SymbolicIndexingInterface.MultipleSetters{Vector{SymbolicIndexingInterface.ParameterHookWrapper{SymbolicIndexingInterface.SetParameterIndex{ModelingToolkit.ParameterIndex{SciMLStructures.Initials, Int64}}, SymbolicUtils.BasicSymbolic{Real}}}}}}, Val{true}}, Nothing}, OrdinaryDiffEqTsit5.Tsit5Cache{Vector{Float64}, Vector{Float64}, Vector{Float64}, typeof(OrdinaryDiffEqCore.trivial_limiter!), typeof(OrdinaryDiffEqCore.trivial_limiter!), Static.False}, OrdinaryDiffEqCore.DEOptions{Float64, Float64, Float64, Float64, OrdinaryDiffEqCore.PIController{Rational{Int64}}, typeof(DiffEqBase.ODE_DEFAULT_NORM), typeof(LinearAlgebra.opnorm), Bool, SciMLBase.CallbackSet{Tuple{}, Tuple{}}, typeof(DiffEqBase.ODE_DEFAULT_ISOUTOFDOMAIN), typeof(DiffEqBase.ODE_DEFAULT_PROG_MESSAGE), typeof(DiffEqBase.ODE_DEFAULT_UNSTABLE_CHECK), DataStructures.BinaryHeap{Float64, DataStructures.FasterForward}, DataStructures.BinaryHeap{Float64, DataStructures.FasterForward}, Nothing, Nothing, Float64, Tuple{}, Tuple{}, Tuple{}}, Vector{Float64}, Float64, Nothing, OrdinaryDiffEqCore.DefaultInit, Nothing}, MTKParameters{Vector{Float64}, Vector{Float64}, Tuple{}, Tuple{}, Tuple{}, Tuple{}}}, Attractors.BasinsInfo{3, Attractors.RegularGrid{3, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Float64, Float64, StaticArraysCore.SVector{3, Float64}, Attractors.SparseArray{Int64, 3}}, Attractors.RegularGrid{3, StepRangeLen{Float64, Base.TwicePrecision{Float64}, Base.TwicePrecision{Float64}, Int64}}, Base.Pairs{Symbol, Int64, Tuple{Symbol, Symbol}, @NamedTuple{consecutive_recurrences::Int64, consecutive_lost_steps::Int64}}}, Attractors.MatchBySSSetDistance{StateSpaceSets.Centroid{Distances.Euclidean}, Float64}, typeof(Attractors._default_seeding)}(AttractorsViaRecurrences
 system:      CoupledODEs
 grid:        (-15.0:0.20134228187919462:15.0, -20.0:0.2684563758389262:20.0, -20.0:0.2684563758389262:20.0)
 attractors:  Dict{Int64, StateSpaceSets.StateSpaceSet{3, Float64, StaticArraysCore.SVector{3, Float64}}}(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 232 points, 1 =&gt; 3-dimensional StateSpaceSet{Float64} with 740 points)
, Attractors.MatchBySSSetDistance{StateSpaceSets.Centroid{Distances.Euclidean}, Float64}(StateSpaceSets.Centroid{Distances.Euclidean}(Distances.Euclidean(0.0)), Inf, false), Attractors._default_seeding)</code></pre><p>we need two more ingredients to perform the global continuation. One is a sampler of initial conditions in the state space. Here we&#39;ll uniformly sample initial conditions within this grid we have already defined</p><pre><code class="language-julia hljs">sampler, = statespace_sampler(grid);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(StateSpaceSets.RectangleGenerator{Float64, StaticArraysCore.SVector{3, Float64}, Random.Xoshiro}([-15.0, -20.0, -20.0], [30.0, 40.0, 40.0], [[0.0, 0.0, 0.0]], Random.Xoshiro(0xb9add3df5358adc3, 0x5deb672e80863bd2, 0x5e4ec95b51d72194, 0x118a15512d1bcfc2, 0x25c08d6ba9e1b76b)), StateSpaceSets.var&quot;#isinside#61&quot;{StaticArraysCore.SVector{3, Float64}, StaticArraysCore.SVector{3, Float64}}([15.0, 20.0, 20.0], [-15.0, -20.0, -20.0]))</code></pre><p>the last ingredient is what parameter(s) to perform the continuation over. In contrast to local continuation, where we can only specify a parameter range, in global continuation one can specify an exact parameter curve to continue over. This curve can span any-dimensional parameter space, in contrast to the 1D or 2D parameter spaces supported in local continuation. Here we will use the curve</p><pre><code class="language-julia hljs">params(θ) = [:a =&gt; 5 + 0.5cos(θ), :b =&gt; 0.1 + 0.01sin(θ)]
θs = range(0, 2π; length = 101)
pcurve = params.(θs)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">101-element Vector{Vector{Pair{Symbol, Float64}}}:
 [:a =&gt; 5.5, :b =&gt; 0.1]
 [:a =&gt; 5.499013364214136, :b =&gt; 0.10062790519529313]
 [:a =&gt; 5.496057350657239, :b =&gt; 0.10125333233564304]
 [:a =&gt; 5.491143625364344, :b =&gt; 0.10187381314585725]
 [:a =&gt; 5.4842915805643155, :b =&gt; 0.10248689887164855]
 [:a =&gt; 5.475528258147577, :b =&gt; 0.10309016994374948]
 [:a =&gt; 5.4648882429441255, :b =&gt; 0.10368124552684678]
 [:a =&gt; 5.45241352623301, :b =&gt; 0.10425779291565074]
 [:a =&gt; 5.438153340021932, :b =&gt; 0.10481753674101715]
 [:a =&gt; 5.422163962751007, :b =&gt; 0.10535826794978997]
 ⋮
 [:a =&gt; 5.438153340021932, :b =&gt; 0.09518246325898286]
 [:a =&gt; 5.45241352623301, :b =&gt; 0.09574220708434927]
 [:a =&gt; 5.4648882429441255, :b =&gt; 0.09631875447315323]
 [:a =&gt; 5.475528258147577, :b =&gt; 0.09690983005625053]
 [:a =&gt; 5.4842915805643155, :b =&gt; 0.09751310112835145]
 [:a =&gt; 5.491143625364344, :b =&gt; 0.09812618685414276]
 [:a =&gt; 5.496057350657239, :b =&gt; 0.09874666766435695]
 [:a =&gt; 5.499013364214136, :b =&gt; 0.09937209480470688]
 [:a =&gt; 5.5, :b =&gt; 0.1]</code></pre><p>which makes an ellipsis over the parameter space.</p><p>We put these three ingredients together to call the global continuation</p><pre><code class="language-julia hljs">fractions_cont, attractors_cont = global_continuation(ascm, pcurve, sampler);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([Dict(2 =&gt; 0.35, 1 =&gt; 0.65), Dict(2 =&gt; 0.20588235294117646, 1 =&gt; 0.7941176470588235), Dict(2 =&gt; 0.20588235294117646, 1 =&gt; 0.7941176470588235), Dict(2 =&gt; 0.20588235294117646, 1 =&gt; 0.7941176470588235), Dict(2 =&gt; 0.2549019607843137, 1 =&gt; 0.7450980392156863), Dict(2 =&gt; 0.22549019607843138, 1 =&gt; 0.7745098039215687), Dict(2 =&gt; 0.27450980392156865, 1 =&gt; 0.7254901960784313), Dict(2 =&gt; 0.2549019607843137, 1 =&gt; 0.7450980392156863), Dict(2 =&gt; 0.2647058823529412, 1 =&gt; 0.7352941176470589), Dict(2 =&gt; 0.2647058823529412, 1 =&gt; 0.7352941176470589)  …  Dict(2 =&gt; 0.2549019607843137, 3 =&gt; 0.7450980392156863), Dict(2 =&gt; 0.27450980392156865, 3 =&gt; 0.7254901960784313), Dict(2 =&gt; 0.3235294117647059, 3 =&gt; 0.6764705882352942), Dict(2 =&gt; 0.3137254901960784, 3 =&gt; 0.6862745098039216), Dict(2 =&gt; 0.22549019607843138, 3 =&gt; 0.7745098039215687), Dict(2 =&gt; 0.1568627450980392, 3 =&gt; 0.8431372549019608), Dict(2 =&gt; 0.2647058823529412, 3 =&gt; 0.7352941176470589), Dict(2 =&gt; 0.30392156862745096, 3 =&gt; 0.696078431372549), Dict(2 =&gt; 0.24509803921568626, 3 =&gt; 0.7549019607843137), Dict(2 =&gt; 0.35294117647058826, 3 =&gt; 0.6470588235294118)], Dict{Int64, StateSpaceSets.StateSpaceSet{3, Float64, StaticArraysCore.SVector{3, Float64}}}[Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 281 points, 1 =&gt; 3-dimensional StateSpaceSet{Float64} with 426 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 271 points, 1 =&gt; 3-dimensional StateSpaceSet{Float64} with 419 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 273 points, 1 =&gt; 3-dimensional StateSpaceSet{Float64} with 528 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 62 points, 1 =&gt; 3-dimensional StateSpaceSet{Float64} with 512 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 276 points, 1 =&gt; 3-dimensional StateSpaceSet{Float64} with 547 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 269 points, 1 =&gt; 3-dimensional StateSpaceSet{Float64} with 581 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 266 points, 1 =&gt; 3-dimensional StateSpaceSet{Float64} with 626 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 267 points, 1 =&gt; 3-dimensional StateSpaceSet{Float64} with 591 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 274 points, 1 =&gt; 3-dimensional StateSpaceSet{Float64} with 531 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 268 points, 1 =&gt; 3-dimensional StateSpaceSet{Float64} with 629 points)  …  Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 272 points, 3 =&gt; 3-dimensional StateSpaceSet{Float64} with 585 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 262 points, 3 =&gt; 3-dimensional StateSpaceSet{Float64} with 542 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 245 points, 3 =&gt; 3-dimensional StateSpaceSet{Float64} with 559 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 249 points, 3 =&gt; 3-dimensional StateSpaceSet{Float64} with 484 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 270 points, 3 =&gt; 3-dimensional StateSpaceSet{Float64} with 532 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 285 points, 3 =&gt; 3-dimensional StateSpaceSet{Float64} with 461 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 256 points, 3 =&gt; 3-dimensional StateSpaceSet{Float64} with 447 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 268 points, 3 =&gt; 3-dimensional StateSpaceSet{Float64} with 427 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 287 points, 3 =&gt; 3-dimensional StateSpaceSet{Float64} with 402 points), Dict(2 =&gt; 3-dimensional StateSpaceSet{Float64} with 271 points, 3 =&gt; 3-dimensional StateSpaceSet{Float64} with 452 points)])</code></pre><p>The output of the continuation is how the attractors and their basins fractions change over this parameter curve. We can visualize this directly using a convenience function</p><pre><code class="language-julia hljs">fig = plot_basins_attractors_curves(
    fractions_cont, attractors_cont, A -&gt; minimum(A[:, 1]), θs
)</code></pre><img src="592c0d4c.png" alt="Example block output"/><p>The top panel shows the relative basins of attractions of the attractors and the bottom panel shows their minimum x-position. The colors correspond to unique attractors. Perhaps making a video is easier to understand:</p><pre><code class="language-julia hljs">animate_attractors_continuation(
    ds, attractors_cont, fractions_cont, pcurve;
    savename = &quot;curvecont.mp4&quot;
);</code></pre><img src="63618766.png" alt="Example block output"/><video width="auto" controls loop>
<source src="../curvecont.mp4" type="video/mp4">
</video><p>To learn more about this global continuation and its various options, and more details about how it compares with local continuation, visit the documentation of <a href="https://juliadynamics.github.io/DynamicalSystemsDocs.jl/attractors/stable/">Attractors.jl</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bifurcation_diagram_computation/">« Bifurcation Diagrams</a><a class="docs-footer-nextpage" href="../SampledData/">Clocks and Sampled-Data Systems »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Friday 4 July 2025 17:10">Friday 4 July 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
