<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>- · ModelingToolkit.jl</title><meta name="title" content="- · ModelingToolkit.jl"/><meta property="og:title" content="- · ModelingToolkit.jl"/><meta property="twitter:title" content="- · ModelingToolkit.jl"/><meta name="description" content="Documentation for ModelingToolkit.jl."/><meta property="og:description" content="Documentation for ModelingToolkit.jl."/><meta property="twitter:description" content="Documentation for ModelingToolkit.jl."/><meta property="og:url" content="https://docs.sciml.ai/ModelingToolkit/stable/API/dynamic_opt/"/><meta property="twitter:url" content="https://docs.sciml.ai/ModelingToolkit/stable/API/dynamic_opt/"/><link rel="canonical" href="https://docs.sciml.ai/ModelingToolkit/stable/API/dynamic_opt/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ModelingToolkit.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ModelingToolkit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../tutorials/ode_modeling/">Getting Started with ModelingToolkit.jl</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/acausal_components/">Acausal Component-Based Modeling</a></li><li><a class="tocitem" href="../../tutorials/nonlinear/">Modeling Nonlinear Systems</a></li><li><a class="tocitem" href="../../tutorials/initialization/">Initialization of Systems</a></li><li><a class="tocitem" href="../../tutorials/optimization/">Modeling Optimization Problems</a></li><li><a class="tocitem" href="../../tutorials/modelingtoolkitize/">Modelingtoolkitize: Automatically Translating Numerical to Symbolic Code</a></li><li><a class="tocitem" href="../../tutorials/programmatically_generating/">Programmatically Generating and Scripting Systems</a></li><li><a class="tocitem" href="../../tutorials/stochastic_diffeq/">Modeling with Stochasticity</a></li><li><a class="tocitem" href="../../tutorials/discrete_system/">(Experimental) Modeling Discrete Systems</a></li><li><a class="tocitem" href="../../tutorials/parameter_identifiability/">Parameter Identifiability in ODE Models</a></li><li><a class="tocitem" href="../../tutorials/change_independent_variable/">Changing the independent variable of ODEs</a></li><li><a class="tocitem" href="../../tutorials/bifurcation_diagram_computation/">Bifurcation Diagrams</a></li><li><a class="tocitem" href="../../tutorials/attractors/">Multi- and Nonlocal- Continuation</a></li><li><a class="tocitem" href="../../tutorials/SampledData/">Clocks and Sampled-Data Systems</a></li><li><a class="tocitem" href="../../tutorials/domain_connections/">Domains</a></li><li><a class="tocitem" href="../../tutorials/callable_params/">Callable parameters and interpolating data</a></li><li><a class="tocitem" href="../../tutorials/linear_analysis/">Linear Analysis</a></li><li><a class="tocitem" href="../../tutorials/disturbance_modeling/">Disturbance and input modeling modeling</a></li><li><a class="tocitem" href="../../tutorials/fmi/">Importing FMUs</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Basic Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/higher_order/">Automatic Transformation of Nth Order ODEs to 1st Order ODEs</a></li><li><a class="tocitem" href="../../examples/spring_mass/">Component-Based Modeling of a Spring-Mass System</a></li><li><a class="tocitem" href="../../examples/modelingtoolkitize_index_reduction/">Automated Index Reduction of DAEs</a></li><li><a class="tocitem" href="../../examples/remake/">Optimizing through an ODE solve and re-creating MTK Problems</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Advanced Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/tearing_parallelism/">Exposing More Parallelism By Tearing Algebraic Equations in Systems</a></li><li><a class="tocitem" href="../../examples/sparse_jacobians/">Automated Sparse Analytical Jacobians</a></li><li><a class="tocitem" href="../../examples/perturbation/">Symbolic-Numeric Perturbation Theory for ODEs</a></li></ul></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../System/">The <code>System</code> type</a></li><li><a class="tocitem" href="../variables/">Symbolic variables and variable metadata</a></li><li><a class="tocitem" href="../model_building/">Model building reference</a></li><li><a class="tocitem" href="../problems/">Building and solving numerical problems</a></li><li><a class="tocitem" href="../codegen/">Code generation utilities</a></li><li><a class="tocitem" href="../PDESystem/">PDESystem</a></li></ul></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../../basics/Composition/">Composing Models and Building Reusable Components</a></li><li><a class="tocitem" href="../../basics/Events/">Event Handling and Callback Functions</a></li><li><a class="tocitem" href="../../basics/Linearization/">Linearization</a></li><li><a class="tocitem" href="../../basics/InputOutput/">Input output</a></li><li><a class="tocitem" href="../../basics/MTKLanguage/">ModelingToolkit Language: Modeling with <code>@mtkmodel</code>, <code>@connectors</code> and <code>@mtkcompile</code></a></li><li><a class="tocitem" href="../../basics/Validation/">Model Validation and Units</a></li><li><a class="tocitem" href="../../basics/Debugging/">Debugging</a></li><li><a class="tocitem" href="../../basics/DependencyGraphs/">Dependency Graphs</a></li><li><a class="tocitem" href="../../basics/Precompilation/">Working with Precompilation and Binary Building</a></li><li><a class="tocitem" href="../../basics/FAQ/">Frequently Asked Questions</a></li></ul></li><li><a class="tocitem" href="../../comparison/">Comparison of ModelingToolkit vs Equation-Based and Block Modeling Languages</a></li><li><a class="tocitem" href="../../internals/">Internal Details</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>-</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>-</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/ModelingToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/ModelingToolkit.jl/blob/master/docs/src/API/dynamic_opt.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h3 id="Solvers"><a class="docs-heading-anchor" href="#Solvers">Solvers</a><a id="Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Solvers" title="Permalink"></a></h3><p>Currently 4 backends are exposed for solving dynamic optimization problems using collocation: JuMP, InfiniteOpt, CasADi, and Pyomo.</p><p>Please note that there are differences in how to construct the collocation solver for the different cases. For example, the Python based ones, CasADi and Pyomo, expect the solver to be passed in as a string (CasADi and Pyomo come pre-loaded with Ipopt, but other solvers may need to be manually installed using <code>pip</code> or <code>conda</code>), while JuMP/InfiniteOpt expect the optimizer object to be passed in directly:</p><pre><code class="nohighlight hljs">JuMPCollocation(Ipopt.Optimizer, constructRK4())
CasADiCollocation(&quot;ipopt&quot;, constructRK4())</code></pre><p><strong>JuMP</strong> and <strong>CasADi</strong> collocation require an ODE tableau to be passed in. These can be constructed by calling the <code>constructX()</code> functions from DiffEqDevTools. The list of tableaus can be found <a href="https://docs.sciml.ai/DiffEqDevDocs/dev/internals/tableaus/">here</a>. If none is passed in, both solvers will default to using Radau second-order with five collocation points.</p><p><strong>Pyomo</strong> and <strong>InfiniteOpt</strong> each have their own built-in collocation methods.</p><ol><li><strong>InfiniteOpt</strong>: The list of InfiniteOpt collocation methods can be found <a href="https://infiniteopt.github.io/InfiniteOpt.jl/stable/guide/derivative/">in the table on this page</a>. If none is passed in, the solver defaults to <code>FiniteDifference(Backward())</code>, which is effectively implicit Euler.</li><li><strong>Pyomo</strong>: The list of Pyomo collocation methods can be found <a href="https://github.com/SciML/Pyomo.jl">at the bottom of this page</a>. If none is passed in, the solver defaults to a <code>LagrangeRadau(3)</code>.</li></ol><p>Some examples of the latter two collocations:</p><pre><code class="language-julia hljs">PyomoCollocation(&quot;ipopt&quot;, LagrangeRadau(2))
InfiniteOptCollocation(Ipopt.Optimizer, OrthogonalCollocation(3))</code></pre><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelingToolkit.JuMPCollocation-API-dynamic_opt" href="#ModelingToolkit.JuMPCollocation-API-dynamic_opt"><code>ModelingToolkit.JuMPCollocation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>JuMP Collocation solver.</p><ul><li>solver: a optimization solver such as Ipopt</li><li>tableau: An ODE RK tableau. Load a tableau by calling a function like <code>constructRK4</code> and may be found at https://docs.sciml.ai/DiffEqDevDocs/stable/internals/tableaus/. If this argument is not passed in, the solver will default to Radau second order.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/ModelingToolkit.jl/blob/122b14028a451171104a515e40cbb508fbf8312d/src/systems/optimal_control_interface.jl#L69-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelingToolkit.InfiniteOptCollocation-API-dynamic_opt" href="#ModelingToolkit.InfiniteOptCollocation-API-dynamic_opt"><code>ModelingToolkit.InfiniteOptCollocation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>InfiniteOpt Collocation solver.</p><ul><li>solver: an optimization solver such as Ipopt</li><li><code>derivative_method</code>: the method used by InfiniteOpt to compute derivatives. The list of possible options can be found at https://infiniteopt.github.io/InfiniteOpt.jl/stable/guide/derivative/. Defaults to FiniteDifference(Backward()).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/ModelingToolkit.jl/blob/122b14028a451171104a515e40cbb508fbf8312d/src/systems/optimal_control_interface.jl#L75-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelingToolkit.CasADiCollocation-API-dynamic_opt" href="#ModelingToolkit.CasADiCollocation-API-dynamic_opt"><code>ModelingToolkit.CasADiCollocation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>CasADi Collocation solver.</p><ul><li>solver: an optimization solver such as Ipopt. Should be given as a string or symbol in all lowercase, e.g. &quot;ipopt&quot;</li><li>tableau: An ODE RK tableau. Load a tableau by calling a function like <code>constructRK4</code> and may be found at https://docs.sciml.ai/DiffEqDevDocs/stable/internals/tableaus/. If this argument is not passed in, the solver will default to Radau second order.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/ModelingToolkit.jl/blob/122b14028a451171104a515e40cbb508fbf8312d/src/systems/optimal_control_interface.jl#L81-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelingToolkit.PyomoCollocation-API-dynamic_opt" href="#ModelingToolkit.PyomoCollocation-API-dynamic_opt"><code>ModelingToolkit.PyomoCollocation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Pyomo Collocation solver.</p><ul><li>solver: an optimization solver such as Ipopt. Should be given as a string or symbol in all lowercase, e.g. &quot;ipopt&quot;</li><li>derivative_method: a derivative method from Pyomo. The choices here are ForwardEuler, BackwardEuler, MidpointEuler, LagrangeRadau, or LagrangeLegendre. The last two should additionally have a number indicating the number of collocation points per timestep, e.g. PyomoCollocation(&quot;ipopt&quot;, LagrangeRadau(3)). Defaults to LagrangeRadau(5).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/ModelingToolkit.jl/blob/122b14028a451171104a515e40cbb508fbf8312d/src/systems/optimal_control_interface.jl#L87-L91">source</a></section></article><div class="admonition is-warning" id="Missing-docstring.-b0e8310d83f64f61"><header class="admonition-header">Missing docstring.<a class="admonition-anchor" href="#Missing-docstring.-b0e8310d83f64f61" title="Permalink"></a></header><div class="admonition-body"><p>Missing docstring for <code>CommonSolve.solve(::AbstractDynamicOptProblem)</code>. Check Documenter&#39;s build log for details.</p></div></div><h3 id="Problem-constructors"><a class="docs-heading-anchor" href="#Problem-constructors">Problem constructors</a><a id="Problem-constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-constructors" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelingToolkit.JuMPDynamicOptProblem-API-dynamic_opt" href="#ModelingToolkit.JuMPDynamicOptProblem-API-dynamic_opt"><code>ModelingToolkit.JuMPDynamicOptProblem</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JuMPDynamicOptProblem(sys::System, u0, tspan, p; dt, steps, guesses, kwargs...)</code></pre><p>Convert an System representing an optimal control system into a JuMP model for solving using optimization. Must provide either <code>dt</code>, the timestep between collocation  points (which, along with the timespan, determines the number of points), or directly  provide the number of points as <code>steps</code>.</p><p>To construct the problem, please load InfiniteOpt along with ModelingToolkit.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/ModelingToolkit.jl/blob/122b14028a451171104a515e40cbb508fbf8312d/src/systems/optimal_control_interface.jl#L21-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelingToolkit.InfiniteOptDynamicOptProblem-API-dynamic_opt" href="#ModelingToolkit.InfiniteOptDynamicOptProblem-API-dynamic_opt"><code>ModelingToolkit.InfiniteOptDynamicOptProblem</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InfiniteOptDynamicOptProblem(sys::System, op, tspan; dt)</code></pre><p>Convert an System representing an optimal control system into a InfiniteOpt model for solving using optimization. Must provide <code>dt</code> for determining the length  of the interpolation arrays.</p><p>Related to <code>JuMPDynamicOptProblem</code>, but directly adds the differential equations of the system as derivative constraints, rather than using a solver tableau.</p><p>To construct the problem, please load InfiniteOpt along with ModelingToolkit.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/ModelingToolkit.jl/blob/122b14028a451171104a515e40cbb508fbf8312d/src/systems/optimal_control_interface.jl#L32-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelingToolkit.CasADiDynamicOptProblem-API-dynamic_opt" href="#ModelingToolkit.CasADiDynamicOptProblem-API-dynamic_opt"><code>ModelingToolkit.CasADiDynamicOptProblem</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CasADiDynamicOptProblem(sys::System, u0, tspan, p; dt, steps, guesses, kwargs...)</code></pre><p>Convert an System representing an optimal control system into a CasADi model for solving using optimization. Must provide either <code>dt</code>, the timestep between collocation  points (which, along with the timespan, determines the number of points), or directly  provide the number of points as <code>steps</code>.</p><p>To construct the problem, please load CasADi along with ModelingToolkit.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/ModelingToolkit.jl/blob/122b14028a451171104a515e40cbb508fbf8312d/src/systems/optimal_control_interface.jl#L45-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelingToolkit.PyomoDynamicOptProblem-API-dynamic_opt" href="#ModelingToolkit.PyomoDynamicOptProblem-API-dynamic_opt"><code>ModelingToolkit.PyomoDynamicOptProblem</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PyomoDynamicOptProblem(sys::System, u0, tspan, p; dt, steps)</code></pre><p>Convert an System representing an optimal control system into a Pyomo model for solving using optimization. Must provide either <code>dt</code>, the timestep between collocation  points (which, along with the timespan, determines the number of points), or directly  provide the number of points as <code>steps</code>.</p><p>To construct the problem, please load Pyomo along with ModelingToolkit.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/ModelingToolkit.jl/blob/122b14028a451171104a515e40cbb508fbf8312d/src/systems/optimal_control_interface.jl#L56-L65">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Tuesday 10 June 2025 03:08">Tuesday 10 June 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
