<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ModelingToolkit Language: Modeling with @mtkmodel, @connectors and @mtkbuild · ModelingToolkit.jl</title><meta name="title" content="ModelingToolkit Language: Modeling with @mtkmodel, @connectors and @mtkbuild · ModelingToolkit.jl"/><meta property="og:title" content="ModelingToolkit Language: Modeling with @mtkmodel, @connectors and @mtkbuild · ModelingToolkit.jl"/><meta property="twitter:title" content="ModelingToolkit Language: Modeling with @mtkmodel, @connectors and @mtkbuild · ModelingToolkit.jl"/><meta name="description" content="Documentation for ModelingToolkit.jl."/><meta property="og:description" content="Documentation for ModelingToolkit.jl."/><meta property="twitter:description" content="Documentation for ModelingToolkit.jl."/><meta property="og:url" content="https://docs.sciml.ai/ModelingToolkit/stable/basics/MTKLanguage/"/><meta property="twitter:url" content="https://docs.sciml.ai/ModelingToolkit/stable/basics/MTKLanguage/"/><link rel="canonical" href="https://docs.sciml.ai/ModelingToolkit/stable/basics/MTKLanguage/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ModelingToolkit.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ModelingToolkit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../tutorials/ode_modeling/">Getting Started with ModelingToolkit.jl</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/acausal_components/">Acausal Component-Based Modeling</a></li><li><a class="tocitem" href="../../tutorials/nonlinear/">Modeling Nonlinear Systems</a></li><li><a class="tocitem" href="../../tutorials/initialization/">Initialization of ODESystems</a></li><li><a class="tocitem" href="../../tutorials/optimization/">Modeling Optimization Problems</a></li><li><a class="tocitem" href="../../tutorials/modelingtoolkitize/">Modelingtoolkitize: Automatically Translating Numerical to Symbolic Code</a></li><li><a class="tocitem" href="../../tutorials/programmatically_generating/">Programmatically Generating and Scripting ODESystems</a></li><li><a class="tocitem" href="../../tutorials/stochastic_diffeq/">Modeling with Stochasticity</a></li><li><a class="tocitem" href="../../tutorials/discrete_system/">(Experimental) Modeling Discrete Systems</a></li><li><a class="tocitem" href="../../tutorials/parameter_identifiability/">Parameter Identifiability in ODE Models</a></li><li><a class="tocitem" href="../../tutorials/bifurcation_diagram_computation/">Bifurcation Diagrams</a></li><li><a class="tocitem" href="../../tutorials/SampledData/">Clocks and Sampled-Data Systems</a></li><li><a class="tocitem" href="../../tutorials/domain_connections/">Domains</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Basic Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/higher_order/">Automatic Transformation of Nth Order ODEs to 1st Order ODEs</a></li><li><a class="tocitem" href="../../examples/spring_mass/">Component-Based Modeling of a Spring-Mass System</a></li><li><a class="tocitem" href="../../examples/modelingtoolkitize_index_reduction/">Automated Index Reduction of DAEs</a></li><li><a class="tocitem" href="../../examples/parsing/">Parsing Expressions into Solvable Systems</a></li><li><a class="tocitem" href="../../examples/remake/">Optimizing through an ODE solve and re-creating MTK Problems</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Advanced Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/tearing_parallelism/">Exposing More Parallelism By Tearing Algebraic Equations in ODESystems</a></li><li><a class="tocitem" href="../../examples/sparse_jacobians/">Automated Sparse Analytical Jacobians</a></li><li><a class="tocitem" href="../../examples/perturbation/">Symbolic-Numeric Perturbation Theory for ODEs</a></li></ul></li></ul></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../AbstractSystem/">The AbstractSystem Interface</a></li><li><a class="tocitem" href="../ContextualVariables/">Contextual Variable Types</a></li><li><a class="tocitem" href="../Variable_metadata/">Symbolic Metadata</a></li><li><a class="tocitem" href="../Composition/">Composing Models and Building Reusable Components</a></li><li><a class="tocitem" href="../Events/">Event Handling and Callback Functions</a></li><li><a class="tocitem" href="../Linearization/">Linearization</a></li><li><a class="tocitem" href="../InputOutput/">Input output</a></li><li class="is-active"><a class="tocitem" href>ModelingToolkit Language: Modeling with <code>@mtkmodel</code>, <code>@connectors</code> and <code>@mtkbuild</code></a><ul class="internal"><li><a class="tocitem" href="#MTK-Model"><span>MTK Model</span></a></li><li><a class="tocitem" href="#Components"><span>Components</span></a></li><li><a class="tocitem" href="#Connectors"><span>Connectors</span></a></li><li><a class="tocitem" href="#More-on-Model.structure"><span>More on <code>Model.structure</code></span></a></li><li><a class="tocitem" href="#Build-structurally-simplified-models:"><span>Build structurally simplified models:</span></a></li></ul></li><li><a class="tocitem" href="../Validation/">Model Validation and Units</a></li><li><a class="tocitem" href="../DependencyGraphs/">Dependency Graphs</a></li><li><a class="tocitem" href="../Precompilation/">Working with Precompilation and Binary Building</a></li><li><a class="tocitem" href="../FAQ/">Frequently Asked Questions</a></li></ul></li><li><span class="tocitem">System Types</span><ul><li><a class="tocitem" href="../../systems/ODESystem/">ODESystem</a></li><li><a class="tocitem" href="../../systems/SDESystem/">SDESystem</a></li><li><a class="tocitem" href="../../systems/JumpSystem/">JumpSystem</a></li><li><a class="tocitem" href="../../systems/NonlinearSystem/">NonlinearSystem</a></li><li><a class="tocitem" href="../../systems/OptimizationSystem/">OptimizationSystem</a></li><li><a class="tocitem" href="../../systems/PDESystem/">PDESystem</a></li></ul></li><li><a class="tocitem" href="../../comparison/">Comparison of ModelingToolkit vs Equation-Based and Block Modeling Languages</a></li><li><a class="tocitem" href="../../internals/">Internal Details</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Basics</a></li><li class="is-active"><a href>ModelingToolkit Language: Modeling with <code>@mtkmodel</code>, <code>@connectors</code> and <code>@mtkbuild</code></a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ModelingToolkit Language: Modeling with <code>@mtkmodel</code>, <code>@connectors</code> and <code>@mtkbuild</code></a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/ModelingToolkit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/ModelingToolkit.jl/blob/master/docs/src/basics/MTKLanguage.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="mtk_language"><a class="docs-heading-anchor" href="#mtk_language">ModelingToolkit Language: Modeling with <code>@mtkmodel</code>, <code>@connectors</code> and <code>@mtkbuild</code></a><a id="mtk_language-1"></a><a class="docs-heading-anchor-permalink" href="#mtk_language" title="Permalink"></a></h1><h2 id="MTK-Model"><a class="docs-heading-anchor" href="#MTK-Model">MTK Model</a><a id="MTK-Model-1"></a><a class="docs-heading-anchor-permalink" href="#MTK-Model" title="Permalink"></a></h2><p>MTK represents components and connectors with <code>Model</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelingToolkit.Model" href="#ModelingToolkit.Model"><code>ModelingToolkit.Model</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Model{F, S}</code></pre><p>ModelingToolkit component or connector with metadata</p><p><strong>Fields</strong></p><ul><li><p><code>f</code>: The constructor that returns ODESystem.</p></li><li><p><code>structure</code>: The dictionary with metadata like keyword arguments (:kwargs), base system this Model extends (:extend), sub-components of the Model (:components), variables (:variables), parameters (:parameters), structural parameters (:structural_parameters) and equations (:equations).</p></li></ul><ul><li><code>isconnector</code>: This flag is <code>true</code> when the Model is a connector and is <code>false</code> when it is a component</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/ModelingToolkit.jl/blob/2f518c4650cc21f955acba5ee2a5fabde43b82ad/src/systems/model_parsing.jl#L1">source</a></section></article><h2 id="Components"><a class="docs-heading-anchor" href="#Components">Components</a><a id="Components-1"></a><a class="docs-heading-anchor-permalink" href="#Components" title="Permalink"></a></h2><p>Components are models from various domains. These models contain unknowns and their equations.</p><h3 id="mtkmodel"><a class="docs-heading-anchor" href="#mtkmodel">Defining components with <code>@mtkmodel</code></a><a id="mtkmodel-1"></a><a class="docs-heading-anchor-permalink" href="#mtkmodel" title="Permalink"></a></h3><p><code>@mtkmodel</code> is a convenience macro to define components. It returns <code>ModelingToolkit.Model</code>, which includes a constructor that returns the ODESystem, a <code>structure</code> dictionary with metadata, and flag <code>isconnector</code> which is set to <code>false</code>.</p><h3 id="What-can-an-MTK-Model-definition-have?"><a class="docs-heading-anchor" href="#What-can-an-MTK-Model-definition-have?">What can an MTK-Model definition have?</a><a id="What-can-an-MTK-Model-definition-have?-1"></a><a class="docs-heading-anchor-permalink" href="#What-can-an-MTK-Model-definition-have?" title="Permalink"></a></h3><p><code>@mtkmodel</code> definition contains begin blocks of</p><ul><li><code>@components</code>: for listing sub-components of the system</li><li><code>@constants</code>: for declaring constants</li><li><code>@defaults</code>: for passing <code>defaults</code> to ODESystem</li><li><code>@equations</code>: for the list of equations</li><li><code>@extend</code>: for extending a base system and unpacking its unknowns</li><li><code>@icon</code> : for embedding the model icon</li><li><code>@parameters</code>: for specifying the symbolic parameters</li><li><code>@structural_parameters</code>: for specifying non-symbolic parameters</li><li><code>@variables</code>: for specifying the unknowns</li><li><code>@continuous_events</code>: for specifying a list of continuous events</li><li><code>@discrete_events</code>: for specifying a list of discrete events</li></ul><p>Let&#39;s explore these in more detail with the following example:</p><pre><code class="language-julia hljs">using ModelingToolkit
using ModelingToolkit: t

@mtkmodel ModelA begin
    @parameters begin
        k
        k_array[1:2]
    end
end

@mtkmodel ModelB begin
    @parameters begin
        p1 = 1.0, [description = &quot;Parameter of ModelB&quot;]
        p2 = 1.0, [description = &quot;Parameter of ModelB&quot;]
    end
end

@mtkmodel ModelC begin
    @icon &quot;https://github.com/SciML/SciMLDocs/blob/main/docs/src/assets/logo.png&quot;
    @constants begin
        c::Int = 1, [description = &quot;Example constant.&quot;]
    end
    @structural_parameters begin
        f = sin
        N = 2
    end
    begin
        v_var = 1.0
    end
    @variables begin
        v(t) = v_var
        v_array(t)[1:2, 1:3]
        v_for_defaults(t)
    end
    @extend ModelB(; p1)
    @components begin
        model_a = ModelA(; k_array)
        model_array_a = [ModelA(; k = i) for i in 1:N]
        model_array_b = for i in 1:N
            k = i^2
            ModelA(; k)
        end
    end
    @equations begin
        model_a.k ~ f(v)
    end
    @defaults begin
        v_for_defaults =&gt; 2.0
    end
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ModelingToolkit.Model{typeof(Main.var&quot;Main&quot;.__ModelC__), Dict{Symbol, Any}}(Main.var&quot;Main&quot;.__ModelC__, Dict{Symbol, Any}(:components =&gt; Any[Union{Expr, Symbol}[:model_a, :ModelA], Union{Expr, Symbol}[:model_array_a, :ModelA, :(1:N)], Union{Expr, Symbol}[:model_array_b, :ModelA, :(1:N)]], :variables =&gt; Dict{Symbol, Dict{Symbol, Any}}(:v =&gt; Dict(:default =&gt; :v_var, :type =&gt; Real), :v_array =&gt; Dict(:type =&gt; Real, :size =&gt; (2, 3)), :v_for_defaults =&gt; Dict(:type =&gt; Real)), :icon =&gt; URI(&quot;https://github.com/SciML/SciMLDocs/blob/main/docs/src/assets/logo.png&quot;), :kwargs =&gt; Dict{Symbol, Dict}(:f =&gt; Dict(:value =&gt; :sin), :N =&gt; Dict(:value =&gt; 2), :v =&gt; Dict{Symbol, Any}(:value =&gt; :v_var, :type =&gt; Real), :v_array =&gt; Dict{Symbol, Union{Nothing, UnionAll}}(:value =&gt; nothing, :type =&gt; AbstractArray{Real}), :v_for_defaults =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real), :p1 =&gt; Dict(:value =&gt; nothing)), :structural_parameters =&gt; Dict{Symbol, Dict}(:f =&gt; Dict(:value =&gt; :sin), :N =&gt; Dict(:value =&gt; 2)), :independent_variable =&gt; t, :constants =&gt; Dict{Symbol, Dict}(:c =&gt; Dict{Symbol, Any}(:value =&gt; 1, :type =&gt; Int64, :description =&gt; &quot;Example constant.&quot;)), :extend =&gt; Any[[:p2, :p1], Symbol(&quot;#mtkmodel__anonymous__ModelB&quot;), :ModelB], :defaults =&gt; Dict{Symbol, Any}(:v_for_defaults =&gt; 2.0), :equations =&gt; Any[&quot;model_a.k ~ f(v)&quot;]…), false)</code></pre><h4 id="@icon"><a class="docs-heading-anchor" href="#@icon"><code>@icon</code></a><a id="@icon-1"></a><a class="docs-heading-anchor-permalink" href="#@icon" title="Permalink"></a></h4><p>An icon can be embedded in 3 ways:</p><ul><li>URI</li><li>Path to a valid image-file.&lt;br&gt; It can be an absolute path. Or, a path relative to an icon directory; which is <code>DEPOT_PATH[1]/mtk_icons</code> by default and can be changed by setting <code>ENV[&quot;MTK_ICONS_DIR&quot;]</code>.&lt;br&gt; Internally, it is saved in the <em>File URI</em> scheme.</li></ul><pre><code class="language-julia hljs">@mtkmodel WithPathtoIcon begin
    @icon &quot;/home/user/.julia/dev/mtk_icons/icon.png&quot;
    # Rest of the model definition
end</code></pre><ul><li>Inlined SVG.</li></ul><pre><code class="language-julia hljs">@mtkmodel WithInlinedSVGIcon begin
    @icon &quot;&quot;&quot;&lt;svg height=&quot;100&quot; width=&quot;100&quot;&gt;
    &lt;circle cx=&quot;50&quot; cy=&quot;50&quot; r=&quot;40&quot; stroke=&quot;green&quot; fill=&quot;none&quot; stroke-width=&quot;3&quot;/&gt;
    &lt;/svg&gt;
    &quot;&quot;&quot;
    # Rest of the model definition
end</code></pre><h4 id="@structural_parameters-begin-block"><a class="docs-heading-anchor" href="#@structural_parameters-begin-block"><code>@structural_parameters</code> begin block</a><a id="@structural_parameters-begin-block-1"></a><a class="docs-heading-anchor-permalink" href="#@structural_parameters-begin-block" title="Permalink"></a></h4><ul><li>This block is for non symbolic input arguments. These are for inputs that usually are not meant to be part of components; but influence how they are defined. One can list inputs like boolean flags, functions etc... here.</li><li>Whenever default values are specified, unlike parameters/variables, they are reflected in the keyword argument list.</li></ul><h4 id="@constants-begin-block"><a class="docs-heading-anchor" href="#@constants-begin-block"><code>@constants</code> begin block</a><a id="@constants-begin-block-1"></a><a class="docs-heading-anchor-permalink" href="#@constants-begin-block" title="Permalink"></a></h4><ul><li>Declare constants in the model definition.</li><li>The values of these can&#39;t be changed by the user.</li><li>This works similar to symbolic constants described <a href="../ContextualVariables/#constants">here</a></li></ul><h4 id="@parameters-and-@variables-begin-block"><a class="docs-heading-anchor" href="#@parameters-and-@variables-begin-block"><code>@parameters</code> and <code>@variables</code> begin block</a><a id="@parameters-and-@variables-begin-block-1"></a><a class="docs-heading-anchor-permalink" href="#@parameters-and-@variables-begin-block" title="Permalink"></a></h4><ul><li>Parameters and variables are declared with respective begin blocks.</li><li>Variables must be functions of an independent variable.</li><li>Optionally, initial guess and metadata can be specified for these parameters and variables. See <code>ModelB</code> in the above example.</li><li>Along with creating parameters and variables, keyword arguments of same name with default value <code>nothing</code> are created.</li><li>Whenever a parameter or variable has initial value, for example <code>v(t) = 0.0</code>, a symbolic variable named <code>v</code> with initial value 0.0 and a keyword argument <code>v</code>, with default value <code>nothing</code> are created. &lt;br&gt; This way, users can optionally pass new value of <code>v</code> while creating a component.</li></ul><pre><code class="language-julia hljs">julia&gt; @mtkbuild model_c1 = ModelC(; v = 2.0);

julia&gt; ModelingToolkit.getdefault(model_c1.v)
2.0</code></pre><h4 id="@extend-begin-block"><a class="docs-heading-anchor" href="#@extend-begin-block"><code>@extend</code> begin block</a><a id="@extend-begin-block-1"></a><a class="docs-heading-anchor-permalink" href="#@extend-begin-block" title="Permalink"></a></h4><ul><li>Partial systems can be extended in a higher system as <code>@extend PartialSystem(; kwargs)</code>.</li><li>Keyword arguments pf partial system in the <code>@extend</code> definition are added as the keyword arguments of the base system.</li><li>Note that in above example, <code>p1</code> is promoted as an argument of <code>ModelC</code>. Users can set the value of <code>p1</code>. However, as <code>p2</code> isn&#39;t listed in the model definition, its initial guess can&#39;t be specified while creating an instance of <code>ModelC</code>.</li></ul><pre><code class="language-julia hljs">julia&gt; @mtkbuild model_c2 = ModelC(; p1 = 2.0)
</code></pre><h4 id="@components-begin-block"><a class="docs-heading-anchor" href="#@components-begin-block"><code>@components</code> begin block</a><a id="@components-begin-block-1"></a><a class="docs-heading-anchor-permalink" href="#@components-begin-block" title="Permalink"></a></h4><ul><li>Declare the subcomponents within <code>@components</code> begin block.</li><li>Array of components can be declared with a for loop or a list comprehension.</li><li>The arguments in these subcomponents are promoted as keyword arguments as <code>subcomponent_name__argname</code> with <code>nothing</code> as default value.</li><li>Whenever components are created with <code>@named</code> macro, these can be accessed with <code>.</code> operator as <code>subcomponent_name.argname</code></li><li>In the above example, as <code>k</code> of <code>model_a</code> isn&#39;t listed while defining the sub-component in <code>ModelC</code>, its default value can&#39;t be modified by users. While <code>k_array</code> can be set as:</li></ul><pre><code class="language-julia hljs">using ModelingToolkit: getdefault

@mtkbuild model_c3 = ModelC(; model_a.k_array = [1.0, 2.0])

getdefault(model_c3.model_a.k_array[1])
# 1.0
getdefault(model_c3.model_a.k_array[2])
# 2.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2.0</code></pre><h4 id="@equations-begin-block"><a class="docs-heading-anchor" href="#@equations-begin-block"><code>@equations</code> begin block</a><a id="@equations-begin-block-1"></a><a class="docs-heading-anchor-permalink" href="#@equations-begin-block" title="Permalink"></a></h4><ul><li>List all the equations here</li></ul><h4 id="@defaults-begin-block"><a class="docs-heading-anchor" href="#@defaults-begin-block"><code>@defaults</code> begin block</a><a id="@defaults-begin-block-1"></a><a class="docs-heading-anchor-permalink" href="#@defaults-begin-block" title="Permalink"></a></h4><ul><li>Default values can be passed as pairs.</li><li>This is equivalent to passing <code>defaults</code> argument to <code>ODESystem</code>.</li></ul><h4 id="@continuous_events-begin-block"><a class="docs-heading-anchor" href="#@continuous_events-begin-block"><code>@continuous_events</code> begin block</a><a id="@continuous_events-begin-block-1"></a><a class="docs-heading-anchor-permalink" href="#@continuous_events-begin-block" title="Permalink"></a></h4><ul><li>Defining continuous events as described <a href="https://docs.sciml.ai/ModelingToolkit/stable/basics/Events/#Continuous-Events">here</a>.</li><li>If this block is not defined in the model, no continuous events will be added.</li></ul><pre><code class="language-julia hljs">using ModelingToolkit
using ModelingToolkit: t

@mtkmodel M begin
    @parameters begin
        k
    end
    @variables begin
        x(t)
        y(t)
    end
    @equations begin
        x ~ k * D(x)
        D(y) ~ -k
    end
    @continuous_events begin
        [x ~ 1.5] =&gt; [x ~ 5, y ~ 5]
        [t ~ 4] =&gt; [x ~ 10]
    end
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ModelingToolkit.Model{typeof(Main.var&quot;Main&quot;.__M__), Dict{Symbol, Any}}(Main.var&quot;Main&quot;.__M__, Dict{Symbol, Any}(:continuous_events =&gt; Any[&quot;[x ~ 1.5] =&gt; [x ~ 5, y ~ 5]&quot;, &quot;[x ~ 1.5] =&gt; [x ~ 5, y ~ 5]&quot;, &quot;[t ~ 4] =&gt; [x ~ 10]&quot;], :variables =&gt; Dict{Symbol, Dict{Symbol, Any}}(:y =&gt; Dict(:type =&gt; Real), :x =&gt; Dict(:type =&gt; Real)), :kwargs =&gt; Dict{Symbol, Dict}(:k =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real), :y =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real), :x =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real)), :independent_variable =&gt; t, :parameters =&gt; Dict{Symbol, Dict{Symbol, Any}}(:k =&gt; Dict(:type =&gt; Real)), :equations =&gt; Any[&quot;x ~ k * D(x)&quot;, &quot;x ~ k * D(x)&quot;, &quot;D(y) ~ -k&quot;]), false)</code></pre><h4 id="@discrete_events-begin-block"><a class="docs-heading-anchor" href="#@discrete_events-begin-block"><code>@discrete_events</code> begin block</a><a id="@discrete_events-begin-block-1"></a><a class="docs-heading-anchor-permalink" href="#@discrete_events-begin-block" title="Permalink"></a></h4><ul><li>Defining discrete events as described <a href="https://docs.sciml.ai/ModelingToolkit/stable/basics/Events/#Discrete-events-support">here</a>.</li><li>If this block is not defined in the model, no discrete events will be added.</li></ul><pre><code class="language-julia hljs">using ModelingToolkit

@mtkmodel M begin
    @parameters begin
        k
    end
    @variables begin
        x(t)
        y(t)
    end
    @equations begin
        x ~ k * D(x)
        D(y) ~ -k
    end
    @discrete_events begin
        (t == 1.5) =&gt; [x ~ x + 5, y ~ 5]
    end
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ModelingToolkit.Model{typeof(Main.var&quot;Main&quot;.__M__), Dict{Symbol, Any}}(Main.var&quot;Main&quot;.__M__, Dict{Symbol, Any}(:variables =&gt; Dict{Symbol, Dict{Symbol, Any}}(:y =&gt; Dict(:type =&gt; Real), :x =&gt; Dict(:type =&gt; Real)), :discrete_events =&gt; Any[&quot;t == 1.5 =&gt; [x ~ x + 5, y ~ 5]&quot;], :kwargs =&gt; Dict{Symbol, Dict}(:k =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real), :y =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real), :x =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real)), :independent_variable =&gt; t, :parameters =&gt; Dict{Symbol, Dict{Symbol, Any}}(:k =&gt; Dict(:type =&gt; Real)), :equations =&gt; Any[&quot;x ~ k * D(x)&quot;, &quot;x ~ k * D(x)&quot;, &quot;D(y) ~ -k&quot;]), false)</code></pre><h4 id="A-begin-block"><a class="docs-heading-anchor" href="#A-begin-block">A begin block</a><a id="A-begin-block-1"></a><a class="docs-heading-anchor-permalink" href="#A-begin-block" title="Permalink"></a></h4><ul><li>Any other Julia operations can be included with dedicated begin blocks.</li></ul><h2 id="Connectors"><a class="docs-heading-anchor" href="#Connectors">Connectors</a><a id="Connectors-1"></a><a class="docs-heading-anchor-permalink" href="#Connectors" title="Permalink"></a></h2><p>Connectors are special models that can be used to connect different components together. MTK provides 3 distinct connectors:</p><ul><li><code>DomainConnector</code>: A connector which has only one unknown which is of <code>Flow</code> type, specified by <code>[connect = Flow]</code>.</li><li><code>StreamConnector</code>: A connector which has atleast one stream variable, specified by <code>[connect = Stream]</code>. A <code>StreamConnector</code> must have exactly one flow variable.</li><li><code>RegularConnector</code>: Connectors that don&#39;t fall under above categories.</li></ul><h3 id="connector"><a class="docs-heading-anchor" href="#connector">Defining connectors with <code>@connector</code></a><a id="connector-1"></a><a class="docs-heading-anchor-permalink" href="#connector" title="Permalink"></a></h3><p><code>@connector</code> returns <code>ModelingToolkit.Model</code>. It includes a constructor that returns a connector ODESystem, a <code>structure</code> dictionary with metadata, and flag <code>isconnector</code> which is set to <code>true</code>.</p><p>A simple connector can be defined with syntax similar to following example:</p><pre><code class="language-julia hljs">using ModelingToolkit
using ModelingToolkit: t

@connector Pin begin
    v(t) = 0.0, [description = &quot;Voltage&quot;]
    i(t), [connect = Flow]
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ModelingToolkit.Model{typeof(Main.__Pin__), Dict{Symbol, Any}}(Main.__Pin__, Dict{Symbol, Any}(:variables =&gt; Dict{Symbol, Dict{Symbol, Any}}(:v =&gt; Dict(:default =&gt; 0.0, :type =&gt; Real, :description =&gt; &quot;Voltage&quot;), :i =&gt; Dict(:type =&gt; Real, :connection_type =&gt; :Flow)), :kwargs =&gt; Dict{Symbol, Dict}(:v =&gt; Dict{Symbol, Any}(:value =&gt; 0.0, :type =&gt; Real), :i =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real)), :independent_variable =&gt; t), true)</code></pre><p>Variables (as functions of independent variable) are listed out in the definition. These variables can optionally have initial values and metadata like <code>description</code>, <code>connect</code> and so on. For more details on setting metadata, check out <a href="../Variable_metadata/#symbolic_metadata">Symbolic Metadata</a>.</p><p>Similar to <code>@mtkmodel</code>, <code>@connector</code> accepts begin blocks of <code>@components</code>, <code>@equations</code>, <code>@extend</code>, <code>@parameters</code>, <code>@structural_parameters</code>, <code>@variables</code>. These keywords mean the same as described above for <code>@mtkmodel</code>. For example, the following <code>HydraulicFluid</code> connector is defined with parameters, variables and equations.</p><pre><code class="language-julia hljs">@connector HydraulicFluid begin
    @parameters begin
        ρ = 997
        β = 2.09e9
        μ = 0.0010016
        n = 1
        let_gas = 1
        ρ_gas = 0.0073955
        p_gas = -1000
    end
    @variables begin
        dm(t) = 0.0, [connect = Flow]
    end
    @equations begin
        dm ~ 0
    end
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ModelingToolkit.Model{typeof(Main.__HydraulicFluid__), Dict{Symbol, Any}}(Main.__HydraulicFluid__, Dict{Symbol, Any}(:variables =&gt; Dict{Symbol, Dict{Symbol, Any}}(:dm =&gt; Dict(:default =&gt; 0.0, :type =&gt; Real, :connection_type =&gt; :Flow)), :kwargs =&gt; Dict{Symbol, Dict}(:p_gas =&gt; Dict{Symbol, Any}(:value =&gt; -1000, :type =&gt; Real), :ρ =&gt; Dict{Symbol, Any}(:value =&gt; 997, :type =&gt; Real), :μ =&gt; Dict{Symbol, Any}(:value =&gt; 0.0010016, :type =&gt; Real), :let_gas =&gt; Dict{Symbol, Any}(:value =&gt; 1, :type =&gt; Real), :n =&gt; Dict{Symbol, Any}(:value =&gt; 1, :type =&gt; Real), :ρ_gas =&gt; Dict{Symbol, Any}(:value =&gt; 0.0073955, :type =&gt; Real), :dm =&gt; Dict{Symbol, Any}(:value =&gt; 0.0, :type =&gt; Real), :β =&gt; Dict{Symbol, Any}(:value =&gt; 2.09e9, :type =&gt; Real)), :independent_variable =&gt; t, :parameters =&gt; Dict{Symbol, Dict{Symbol, Any}}(:p_gas =&gt; Dict(:default =&gt; -1000, :type =&gt; Real), :ρ =&gt; Dict(:default =&gt; 997, :type =&gt; Real), :μ =&gt; Dict(:default =&gt; 0.0010016, :type =&gt; Real), :let_gas =&gt; Dict(:default =&gt; 1, :type =&gt; Real), :n =&gt; Dict(:default =&gt; 1, :type =&gt; Real), :ρ_gas =&gt; Dict(:default =&gt; 0.0073955, :type =&gt; Real), :β =&gt; Dict(:default =&gt; 2.09e9, :type =&gt; Real)), :equations =&gt; Any[&quot;dm ~ 0&quot;]), true)</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For more examples of usage, checkout <a href="https://github.com/SciML/ModelingToolkitStandardLibrary.jl/">ModelingToolkitStandardLibrary.jl</a></p></div></div><h2 id="More-on-Model.structure"><a class="docs-heading-anchor" href="#More-on-Model.structure">More on <code>Model.structure</code></a><a id="More-on-Model.structure-1"></a><a class="docs-heading-anchor-permalink" href="#More-on-Model.structure" title="Permalink"></a></h2><p><code>structure</code> stores metadata that describes composition of a model. It includes:</p><ul><li><code>:components</code>: The list of sub-components in the form of [[name, sub<em>component</em>name],...].</li><li><code>:constants</code>: Dictionary of constants mapped to its metadata.</li><li><code>:defaults</code>: Dictionary of variables and default values specified in the <code>@defaults</code>.</li><li><code>:extend</code>: The list of extended unknowns, name given to the base system, and name of the base system.</li><li><code>:structural_parameters</code>: Dictionary of structural parameters mapped to their metadata.</li><li><code>:parameters</code>: Dictionary of symbolic parameters mapped to their metadata. For parameter arrays, length is added to the metadata as <code>:size</code>.</li><li><code>:variables</code>: Dictionary of symbolic variables mapped to their metadata. For variable arrays, length is added to the metadata as <code>:size</code>.</li><li><code>:kwargs</code>: Dictionary of keyword arguments mapped to their metadata.</li><li><code>:independent_variable</code>: Independent variable, which is added while generating the Model.</li><li><code>:equations</code>: List of equations (represented as strings).</li></ul><p>For example, the structure of <code>ModelC</code> is:</p><pre><code class="language-julia hljs">julia&gt; ModelC.structure
Dict{Symbol, Any} with 10 entries:
  :components            =&gt; Any[Union{Expr, Symbol}[:model_a, :ModelA], Union{Expr, Symbol}[:model_array_a, :ModelA, :(1:N)], Union{Expr, Symbol}[:model_array_b, :ModelA, :(1:N)]]
  :variables             =&gt; Dict{Symbol, Dict{Symbol, Any}}(:v=&gt;Dict(:default=&gt;:v_var, :type=&gt;Real), :v_array=&gt;Dict(:type=&gt;Real, :size=&gt;(2, 3)), :v_for_defaults=&gt;Dict(:type=&gt;Real))
  :icon                  =&gt; URI(&quot;https://github.com/SciML/SciMLDocs/blob/main/docs/src/assets/logo.png&quot;)
  :kwargs                =&gt; Dict{Symbol, Dict}(:f=&gt;Dict(:value=&gt;:sin), :N=&gt;Dict(:value=&gt;2), :v=&gt;Dict{Symbol, Any}(:value=&gt;:v_var, :type=&gt;Real), :v_array=&gt;Dict{Symbol, Union{Nothing, UnionAll}}(:value=&gt;nothing, :type=&gt;AbstractArray{Real}), :v_for_defaults=&gt;Dict{Symbol, Union{Nothing, DataType}}(:value=&gt;nothing, :type=&gt;Real), :p1=&gt;Dict(:value=&gt;nothing))
  :structural_parameters =&gt; Dict{Symbol, Dict}(:f=&gt;Dict(:value=&gt;:sin), :N=&gt;Dict(:value=&gt;2))
  :independent_variable  =&gt; t
  :constants             =&gt; Dict{Symbol, Dict}(:c=&gt;Dict{Symbol, Any}(:value=&gt;1, :type=&gt;Int64, :description=&gt;&quot;Example constant.&quot;))
  :extend                =&gt; Any[[:p2, :p1], Symbol(&quot;#mtkmodel__anonymous__ModelB&quot;), :ModelB]
  :defaults              =&gt; Dict{Symbol, Any}(:v_for_defaults=&gt;2.0)
  :equations             =&gt; Any[&quot;model_a.k ~ f(v)&quot;]</code></pre><h3 id="Using-conditional-statements"><a class="docs-heading-anchor" href="#Using-conditional-statements">Using conditional statements</a><a id="Using-conditional-statements-1"></a><a class="docs-heading-anchor-permalink" href="#Using-conditional-statements" title="Permalink"></a></h3><h4 id="Conditional-elements-of-the-system"><a class="docs-heading-anchor" href="#Conditional-elements-of-the-system">Conditional elements of the system</a><a id="Conditional-elements-of-the-system-1"></a><a class="docs-heading-anchor-permalink" href="#Conditional-elements-of-the-system" title="Permalink"></a></h4><p>Both <code>@mtkmodel</code> and <code>@connector</code> support conditionally defining parameters, variables, equations, and components.</p><p>The if-elseif-else statements can be used inside <code>@equations</code>, <code>@parameters</code>, <code>@variables</code>, <code>@components</code>.</p><pre><code class="language-julia hljs">using ModelingToolkit
using ModelingToolkit: t

@mtkmodel C begin end

@mtkmodel BranchInsideTheBlock begin
    @structural_parameters begin
        flag = true
    end
    @parameters begin
        if flag
            a1
        else
            a2
        end
    end
    @components begin
        if flag
            sys1 = C()
        else
            sys2 = C()
        end
    end
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ModelingToolkit.Model{typeof(Main.var&quot;Main&quot;.__BranchInsideTheBlock__), Dict{Symbol, Any}}(Main.var&quot;Main&quot;.__BranchInsideTheBlock__, Dict{Symbol, Any}(:components =&gt; Any[(:if, :flag, Vector{Union{Expr, Symbol}}[[:sys1, :C]], Vector{Union{Expr, Symbol}}[[:sys2, :C]])], :kwargs =&gt; Dict{Symbol, Dict}(:flag =&gt; Dict{Symbol, Bool}(:value =&gt; 1)), :structural_parameters =&gt; Dict{Symbol, Dict}(:flag =&gt; Dict{Symbol, Bool}(:value =&gt; 1)), :independent_variable =&gt; t, :parameters =&gt; Dict{Symbol, Dict{Symbol, Any}}(:a2 =&gt; Dict(:type =&gt; AbstractArray{Real}, :condition =&gt; (:if, :flag, Dict{Symbol, Any}(:kwargs =&gt; Dict{Any, Any}(:a1 =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real)), :parameters =&gt; Any[Dict{Symbol, Dict{Symbol, Any}}(:a1 =&gt; Dict(:type =&gt; AbstractArray{Real}))]), Dict{Symbol, Any}(:variables =&gt; Any[Dict{Symbol, Dict{Symbol, Any}}()], :kwargs =&gt; Dict{Any, Any}(:a2 =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real)), :parameters =&gt; Any[Dict{Symbol, Dict{Symbol, Any}}(:a2 =&gt; Dict(:type =&gt; AbstractArray{Real}))]))), :a1 =&gt; Dict(:type =&gt; AbstractArray{Real}, :condition =&gt; (:if, :flag, Dict{Symbol, Any}(:kwargs =&gt; Dict{Any, Any}(:a1 =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real)), :parameters =&gt; Any[Dict{Symbol, Dict{Symbol, Any}}(:a1 =&gt; Dict(:type =&gt; AbstractArray{Real}))]), Dict{Symbol, Any}(:variables =&gt; Any[Dict{Symbol, Dict{Symbol, Any}}()], :kwargs =&gt; Dict{Any, Any}(:a2 =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real)), :parameters =&gt; Any[Dict{Symbol, Dict{Symbol, Any}}(:a2 =&gt; Dict(:type =&gt; AbstractArray{Real}))]))))), false)</code></pre><p>Alternatively, the <code>@equations</code>, <code>@parameters</code>, <code>@variables</code>, <code>@components</code> can be used inside the if-elseif-else statements.</p><pre><code class="language-julia hljs">@mtkmodel BranchOutsideTheBlock begin
    @structural_parameters begin
        flag = true
    end
    if flag
        @parameters begin
            a1
        end
        @components begin
            sys1 = C()
        end
        @equations begin
            a1 ~ 0
        end
    else
        @parameters begin
            a2
        end
        @equations begin
            a2 ~ 0
        end
    end
    @defaults begin
        a1 =&gt; 10
    end
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ModelingToolkit.Model{typeof(Main.var&quot;Main&quot;.__BranchOutsideTheBlock__), Dict{Symbol, Any}}(Main.var&quot;Main&quot;.__BranchOutsideTheBlock__, Dict{Symbol, Any}(:components =&gt; Any[(:if, :flag, Vector{Union{Expr, Symbol}}[[:sys1, :C]], Any[])], :kwargs =&gt; Dict{Symbol, Dict}(:flag =&gt; Dict{Symbol, Bool}(:value =&gt; 1)), :structural_parameters =&gt; Dict{Symbol, Dict}(:flag =&gt; Dict{Symbol, Bool}(:value =&gt; 1)), :independent_variable =&gt; t, :parameters =&gt; Dict{Symbol, Dict{Symbol, Any}}(:a2 =&gt; Dict(:type =&gt; AbstractArray{Real}, :condition =&gt; (:if, :flag, Dict{Symbol, Any}(:kwargs =&gt; Dict{Any, Any}(:a1 =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real)), :parameters =&gt; Any[Dict{Symbol, Dict{Symbol, Any}}(:a1 =&gt; Dict(:type =&gt; AbstractArray{Real}))]), Dict{Symbol, Any}(:variables =&gt; Any[Dict{Symbol, Dict{Symbol, Any}}()], :kwargs =&gt; Dict{Any, Any}(:a2 =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real)), :parameters =&gt; Any[Dict{Symbol, Dict{Symbol, Any}}(:a2 =&gt; Dict(:type =&gt; AbstractArray{Real}))]))), :a1 =&gt; Dict(:type =&gt; AbstractArray{Real}, :condition =&gt; (:if, :flag, Dict{Symbol, Any}(:kwargs =&gt; Dict{Any, Any}(:a1 =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real)), :parameters =&gt; Any[Dict{Symbol, Dict{Symbol, Any}}(:a1 =&gt; Dict(:type =&gt; AbstractArray{Real}))]), Dict{Symbol, Any}(:variables =&gt; Any[Dict{Symbol, Dict{Symbol, Any}}()], :kwargs =&gt; Dict{Any, Any}(:a2 =&gt; Dict{Symbol, Union{Nothing, DataType}}(:value =&gt; nothing, :type =&gt; Real)), :parameters =&gt; Any[Dict{Symbol, Dict{Symbol, Any}}(:a2 =&gt; Dict(:type =&gt; AbstractArray{Real}))])))), :defaults =&gt; Dict{Symbol, Any}(:a1 =&gt; 10), :equations =&gt; Any[(:if, :flag, [&quot;a1 ~ 0&quot;], [&quot;a2 ~ 0&quot;])]), false)</code></pre><p>The conditional parts are reflected in the <code>structure</code>. For <code>BranchOutsideTheBlock</code>, the metadata is:</p><pre><code class="language-julia hljs">julia&gt; BranchOutsideTheBlock.structure
Dict{Symbol, Any} with 7 entries:
  :components            =&gt; Any[(:if, :flag, Vector{Union{Expr, Symbol}}[[:sys1, :C]], Any[])]
  :kwargs                =&gt; Dict{Symbol, Dict}(:flag=&gt;Dict{Symbol, Bool}(:value=&gt;1))
  :structural_parameters =&gt; Dict{Symbol, Dict}(:flag=&gt;Dict{Symbol, Bool}(:value=&gt;1))
  :independent_variable  =&gt; t
  :parameters            =&gt; Dict{Symbol, Dict{Symbol, Any}}(:a2 =&gt; Dict(:type=&gt;AbstractArray{Real}, :condition=&gt;(:if, :flag, Dict{Symbol, Any}(:kwargs=&gt;Dict{Any, Any}(:a1=&gt;Dict{Symbol, Union{Nothing, DataType}}(:value=&gt;nothing, :type=&gt;Real)), :parameters=&gt;Any[Dict{Symbol, Dict{Symbol, Any}}(:a1=&gt;Dict(:type=&gt;AbstractArray{Real}))]), Dict{Symbol, Any}(:variables=&gt;Any[Dict{Symbol, Dict{Symbol, Any}}()], :kwargs=&gt;Dict{Any, Any}(:a2=&gt;Dict{Symbol, Union{Nothing, DataType}}(:value=&gt;nothing, :type=&gt;Real)), :parameters=&gt;Any[Dict{Symbol, Dict{Symbol, Any}}(:a2=&gt;Dict(:type=&gt;AbstractArray{Real}))]))), :a1 =&gt; Dict(:type=&gt;AbstractArray{Real}, :condition=&gt;(:if, :flag, Dict{Symbol, Any}(:kwargs=&gt;Dict{Any, Any}(:a1=&gt;Dict{Symbol, Union{Nothing, DataType}}(:value=&gt;nothing, :type=&gt;Real)), :parameters=&gt;Any[Dict{Symbol, Dict{Symbol, Any}}(:a1=&gt;Dict(:type=&gt;AbstractArray{Real}))]), Dict{Symbol, Any}(:variables=&gt;Any[Dict{Symbol, Dict{Symbol, Any}}()], :kwargs=&gt;Dict{Any, Any}(:a2=&gt;Dict{Symbol, Union{Nothing, DataType}}(:value=&gt;nothing, :type=&gt;Real)), :parameters=&gt;Any[Dict{Symbol, Dict{Symbol, Any}}(:a2=&gt;Dict(:type=&gt;AbstractArray{Real}))]))))
  :defaults              =&gt; Dict{Symbol, Any}(:a1=&gt;10)
  :equations             =&gt; Any[(:if, :flag, [&quot;a1 ~ 0&quot;], [&quot;a2 ~ 0&quot;])]</code></pre><p>Conditional entries are entered in the format of <code>(branch, condition, [case when it is true], [case when it is false])</code>; where <code>branch</code> is either <code>:if</code> or <code>:elseif</code>.&lt;br&gt; The <code>[case when it is false]</code> is either an empty vector or <code>nothing</code> when only if branch is present; it is a vector or dictionary whenever else branch is present; it is a conditional tuple whenever elseif branches are present.</p><p>For the conditional components and equations these condition tuples are added directly, while for parameters and variables these are added as <code>:condition</code> metadata.</p><h4 id="Conditional-initial-guess-of-symbolic-variables"><a class="docs-heading-anchor" href="#Conditional-initial-guess-of-symbolic-variables">Conditional initial guess of symbolic variables</a><a id="Conditional-initial-guess-of-symbolic-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Conditional-initial-guess-of-symbolic-variables" title="Permalink"></a></h4><p>Using ternary operator or if-elseif-else statement, conditional initial guesses can be assigned to parameters and variables.</p><pre><code class="language-julia hljs">@mtkmodel DefaultValues begin
    @structural_parameters begin
        flag = true
    end
    @parameters begin
        p = flag ? 1 : 2
    end
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ModelingToolkit.Model{typeof(Main.var&quot;Main&quot;.__DefaultValues__), Dict{Symbol, Any}}(Main.var&quot;Main&quot;.__DefaultValues__, Dict{Symbol, Any}(:kwargs =&gt; Dict{Symbol, Dict}(:p =&gt; Dict{Symbol, Any}(:value =&gt; :(if flag
      1
  else
      2
  end), :type =&gt; Real), :flag =&gt; Dict{Symbol, Bool}(:value =&gt; 1)), :structural_parameters =&gt; Dict{Symbol, Dict}(:flag =&gt; Dict{Symbol, Bool}(:value =&gt; 1)), :independent_variable =&gt; t, :parameters =&gt; Dict{Symbol, Dict{Symbol, Any}}(:p =&gt; Dict(:default =&gt; :(if flag
      1
  else
      2
  end), :type =&gt; Real))), false)</code></pre><h2 id="Build-structurally-simplified-models:"><a class="docs-heading-anchor" href="#Build-structurally-simplified-models:">Build structurally simplified models:</a><a id="Build-structurally-simplified-models:-1"></a><a class="docs-heading-anchor-permalink" href="#Build-structurally-simplified-models:" title="Permalink"></a></h2><p><code>@mtkbuild</code> builds an instance of a component and returns a structurally simplied <code>ODESystem</code>.</p><pre><code class="language-julia hljs">@mtkbuild sys = CustomModel()</code></pre><p>This is equivalent to:</p><pre><code class="language-julia hljs">@named model = CustomModel()
sys = structural_simplify(model)</code></pre><p>Pass keyword arguments to <code>structural_simplify</code> using the following syntax:</p><pre><code class="language-julia hljs">@mtkbuild sys=CustomModel() fully_determined=false</code></pre><p>This is equivalent to:</p><pre><code class="language-julia hljs">@named model = CustomModel()
sys = structural_simplify(model; fully_determined = false)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../InputOutput/">« Input output</a><a class="docs-footer-nextpage" href="../Validation/">Model Validation and Units »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Monday 9 September 2024 03:04">Monday 9 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
